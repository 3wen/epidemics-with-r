<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.475">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Modelling epidemics with R - 6&nbsp; Background on Phenomenological Models</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./phenomenological-models.html" rel="next">
<link href="./reproduction-number.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({ TeX: { extensions: ["color.js"] }});
</script>
<script type="text/x-mathjax-config">
	MathJax.Hub.Register.StartupHook("TeX color Ready", function() {
	     MathJax.Extension["TeX/color"].colors["wongBlack"] = '#000000';
		 MathJax.Extension["TeX/color"].colors["wongGold"] = '#E69F00';
		 MathJax.Extension["TeX/color"].colors["wongLightBlue"] = '#56B4E9';
		 MathJax.Extension["TeX/color"].colors["wongGreen"] = '#009E73';
		 MathJax.Extension["TeX/color"].colors["wongYellow"] = '#F0E442';
		 MathJax.Extension["TeX/color"].colors["wongBlue"] = '#0072B2';
		 MathJax.Extension["TeX/color"].colors["wongOrange"] = '#D55E00';
		 MathJax.Extension["TeX/color"].colors["wongPurple"] = '#CC79A7';
		 
		 
		 MathJax.Extension["TeX/color"].colors["IBMBlue"] = '#648FFF';
		 MathJax.Extension["TeX/color"].colors["IBMPurple"] = '#785EF0';
		 MathJax.Extension["TeX/color"].colors["IBMMagenta"] = '#DC267F';
		 MathJax.Extension["TeX/color"].colors["IBMOrange"] = '#FE6100';
		 MathJax.Extension["TeX/color"].colors["IBMYellow"] = '#FFB000';
	});
</script>

  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
    <div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Background on Phenomenological Models</span></h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Modelling epidemics with R</a> 
        <div class="sidebar-tools-main">
    <a href="https://github.com/3wen/epidemics-with-r" title="Source Code" class="sidebar-tool px-1"><i class="bi bi-github"></i></a>
</div>
    </div>
      </div>
      <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">Preface</a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">SIR Model</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./SIR-background.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Theoretical background</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./SIR-simulations.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Simulations with R</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./SIR-animations.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Animations with R</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">Statistical Models</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./covid-data.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Covid-19 Data</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./reproduction-number.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Estimating the reproduction number</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./phenomeological-background.html" class="sidebar-item-text sidebar-link active"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Background on Phenomenological Models</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./phenomenological-models.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Phenomenological Models</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">References</a>
  </div>
</li>
    </ul>
    </div>
</nav>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#simple-phenomenological-models" id="toc-simple-phenomenological-models" class="nav-link active" data-scroll-target="#simple-phenomenological-models"><span class="toc-section-number">6.1</span>  Simple phenomenological models</a>
  <ul class="collapse">
  <li><a href="#a-generic-equation" id="toc-a-generic-equation" class="nav-link" data-scroll-target="#a-generic-equation"><span class="toc-section-number">6.1.1</span>  A Generic Equation</a></li>
  <li><a href="#logistic-model" id="toc-logistic-model" class="nav-link" data-scroll-target="#logistic-model"><span class="toc-section-number">6.1.2</span>  Logistic Model</a></li>
  <li><a href="#gompertz-model" id="toc-gompertz-model" class="nav-link" data-scroll-target="#gompertz-model"><span class="toc-section-number">6.1.3</span>  Gompertz Model</a></li>
  <li><a href="#richards-model" id="toc-richards-model" class="nav-link" data-scroll-target="#richards-model"><span class="toc-section-number">6.1.4</span>  Richards Model</a></li>
  </ul></li>
  <li><a href="#double-sigmoid-functions-to-account-for-a-second-wave" id="toc-double-sigmoid-functions-to-account-for-a-second-wave" class="nav-link" data-scroll-target="#double-sigmoid-functions-to-account-for-a-second-wave"><span class="toc-section-number">6.2</span>  Double sigmoid functions to account for a second wave</a>
  <ul class="collapse">
  <li><a href="#double-logistic" id="toc-double-logistic" class="nav-link" data-scroll-target="#double-logistic"><span class="toc-section-number">6.2.1</span>  Double Logistic</a></li>
  <li><a href="#double-gompertz-model" id="toc-double-gompertz-model" class="nav-link" data-scroll-target="#double-gompertz-model"><span class="toc-section-number">6.2.2</span>  Double Gompertz Model</a></li>
  <li><a href="#double-richards-model" id="toc-double-richards-model" class="nav-link" data-scroll-target="#double-richards-model"><span class="toc-section-number">6.2.3</span>  Double Richards Model</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span id="sec-phenomenological-models-background" class="quarto-section-identifier d-none d-lg-block"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Background on Phenomenological Models</span></span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<p>This chapter provides a bit of background about phenomenological models that can be used to model an epidemic.</p>
<section id="simple-phenomenological-models" class="level2" data-number="6.1">
<h2 data-number="6.1" class="anchored" data-anchor-id="simple-phenomenological-models"><span class="header-section-number">6.1</span> Simple phenomenological models</h2>
<p>We will present three models to estimate the number of cases and the number of deaths: the logistic model, the Gompertz model, and the Richards model.</p>
<section id="a-generic-equation" class="level3" data-number="6.1.1">
<h3 data-number="6.1.1" class="anchored" data-anchor-id="a-generic-equation"><span class="header-section-number">6.1.1</span> A Generic Equation</h3>
<p><span class="citation" data-cites="Wang-etal2012">Wang, Wu, and Yang (<a href="references.html#ref-Wang-etal2012" role="doc-biblioref">2012</a>)</span> develop the similarity between the SIR model and the Richards population model <span class="citation" data-cites="richards_flexible_1959">Richards (<a href="references.html#ref-richards_flexible_1959" role="doc-biblioref">1959</a>)</span> which lead them to consider the following growth equation for confirmed cases noted <span class="math inline">\(C(t)\)</span>: <span id="eq-leqbase"><span class="math display">\[
\frac{d\, C}{d\, t} = r C^\alpha\left[1-\left(\frac{C}{K}\right)^\delta\right],
\tag{6.1}\]</span></span> with <span class="math inline">\(r\)</span>, <span class="math inline">\(\alpha\)</span>, <span class="math inline">\(\delta\)</span> and <span class="math inline">\(K\)</span> being positive real numbers with the further restriction <span class="math inline">\(0\leq\alpha\leq 1\)</span>.</p>
<p>A general solution to this equation has the form: <span class="math display">\[
C(t) = F(r,\alpha,\delta,K,t),
\]</span> with the property that <span class="math inline">\(\lim_{t \rightarrow\infty} C(t) = K\)</span>. If <span class="math inline">\(C(t)\)</span> corresponds to the total number of cases, the number of new cases is found by computing the derivative of <span class="math inline">\(C(t)\)</span> with respect to <span class="math inline">\(t\)</span> and noted <span class="math inline">\(c(t)\)</span>. The relative speed of the process is defined as <span class="math inline">\(c(t)/C(t)\)</span> and is constant over time only when <span class="math inline">\(\alpha=1\)</span>, <span class="math inline">\(\delta=0\)</span>. The doubling time is constant over time only under those restrictions.</p>
<p>A crucial question is to characterize the speed at which the process will reach its peak and when. <span class="citation" data-cites="tsoularis_analysis_2002">Tsoularis and Wallace (<a href="references.html#ref-tsoularis_analysis_2002" role="doc-biblioref">2002</a>)</span> have shown that the value of the peak is given by the value of <span class="math inline">\(C\)</span> at the inflexion point of the curve: <span id="eq-lN-inf"><span class="math display">\[
C_{inf} = K \left(1+\frac{\delta}{\alpha}\right)^{-1/\delta}.
\tag{6.2}\]</span></span> The corresponding time, that we shall note <span class="math inline">\(\tau\)</span> is obtained by inverting <span class="math inline">\(C(t)\)</span>. For some models, when an analytical expression for <span class="math inline">\(C(t)\)</span> is available, <span class="math inline">\(\tau\)</span> can be directly included in the parameterization. This point is of particular importance because it corresponds to the period when the epidemic starts to regress, or equivalently when the effective reproduction number <span class="math inline">\(R_t\)</span> starts to be below 1.</p>
</section>
<section id="logistic-model" class="level3" data-number="6.1.2">
<h3 data-number="6.1.2" class="anchored" data-anchor-id="logistic-model"><span class="header-section-number">6.1.2</span> Logistic Model</h3>
<p>The logistic model initiated by <span class="citation" data-cites="verhulst_recherches_1845">Verhulst (<a href="references.html#ref-verhulst_recherches_1845" role="doc-biblioref">1845</a>)</span> provides the most simple solution to the <a href="#eq-leqbase">Equation&nbsp;<span>6.1</span></a> and corresponds to <span class="math inline">\(\alpha=\delta=1\)</span>: <span id="eq-equationlogistic"><span class="math display">\[
C(t) = \frac{K}{1+\exp\left(-r (t - \tau)\right)}.
\tag{6.3}\]</span></span></p>
<p>It has been recently applied to study the evolution of an epidemic <span class="citation" data-cites="ma_estimating_2020">Ma (<a href="references.html#ref-ma_estimating_2020" role="doc-biblioref">2020</a>)</span>. We have introduced a parameterization where <span class="math inline">\(\tau\)</span> directly represents the inflection point with that <span class="math inline">\(C(\tau) = K/2\)</span>. So the peak is at the mid of the epidemic which reaches its cumulated maximum <span class="math inline">\(K\)</span>, <span class="math inline">\(r\)</span> representing the growth rate. The first order derivative of this function provides an estimate of the number of cases at each point in time: <span class="math display">\[
\frac{\partial C(t)}{\partial t} = \frac{K r \exp\left(-r(t-\tau)\right)}{\left[1+\exp(-r(t-\tau)\right]^2}.
\]</span> The relative speed is thus: <span class="math display">\[
\frac{c(t)}{C(t)} = r \frac{e^{-r(t-\tau)}}{1+e^{-r(t-\tau)}}.
\]</span> This model might appear as a nice solution to represents the three phases of an epidemic, but we shall discover below that its symmetry tends to be in contradiction with epidemic data. So we have to explore alternative solutions.</p>
<p>In R, we define the logistic function as follows:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co">#' Logistic function</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="co">#' </span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="co">#' @param theta vector of named parameters</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="co">#' @param x time</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>logistic_f <span class="ot">&lt;-</span>  <span class="cf">function</span>(theta, x) {</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>  k <span class="ot">&lt;-</span> theta[[<span class="st">"k"</span>]]</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>  tau <span class="ot">&lt;-</span> theta[[<span class="st">"tau"</span>]]</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>  r <span class="ot">&lt;-</span> theta[[<span class="st">"r"</span>]]</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>  k <span class="sc">/</span> ( <span class="dv">1</span><span class="sc">+</span><span class="fu">exp</span>( <span class="sc">-</span>r<span class="sc">*</span>( x <span class="sc">-</span> tau ) ) )</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="co">#' First derivative of the logistic function</span></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="co">#' </span></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="co">#' @param theta vector of named parameters</span></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a><span class="co">#' @param x time</span></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>logistic_f_first_d <span class="ot">&lt;-</span> <span class="cf">function</span>(theta, x) {</span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a>  k <span class="ot">&lt;-</span> theta[[<span class="st">"k"</span>]]</span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a>  tau <span class="ot">&lt;-</span> theta[[<span class="st">"tau"</span>]]</span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a>  r <span class="ot">&lt;-</span> theta[[<span class="st">"r"</span>]]</span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a>  (k <span class="sc">*</span> r <span class="sc">*</span> <span class="fu">exp</span>( <span class="sc">-</span>r <span class="sc">*</span> (x <span class="sc">-</span> tau) )) <span class="sc">/</span> (<span class="dv">1</span><span class="sc">+</span> <span class="fu">exp</span>( <span class="sc">-</span>r <span class="sc">*</span> (x <span class="sc">-</span> tau) ))<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a><span class="co">#' Second derivative of the logistic function</span></span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a><span class="co">#' </span></span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a><span class="co">#' @param theta vector of named parameters</span></span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a><span class="co">#' @param x time</span></span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a>logistic_f_second_d <span class="ot">&lt;-</span> <span class="cf">function</span>(theta, x) {</span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a>  k <span class="ot">&lt;-</span> theta[[<span class="st">"k"</span>]]</span>
<span id="cb1-30"><a href="#cb1-30" aria-hidden="true" tabindex="-1"></a>  tau <span class="ot">&lt;-</span> theta[[<span class="st">"tau"</span>]]</span>
<span id="cb1-31"><a href="#cb1-31" aria-hidden="true" tabindex="-1"></a>  r <span class="ot">&lt;-</span> theta[[<span class="st">"r"</span>]]</span>
<span id="cb1-32"><a href="#cb1-32" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-33"><a href="#cb1-33" aria-hidden="true" tabindex="-1"></a>  k<span class="sc">*</span>((<span class="dv">2</span><span class="sc">*</span>r<span class="sc">^</span><span class="dv">2</span> <span class="sc">*</span> <span class="fu">exp</span>(<span class="sc">-</span><span class="dv">2</span><span class="sc">*</span>r<span class="sc">*</span>(x <span class="sc">-</span> tau)))<span class="sc">/</span></span>
<span id="cb1-34"><a href="#cb1-34" aria-hidden="true" tabindex="-1"></a>       (<span class="fu">exp</span>(<span class="sc">-</span>r<span class="sc">*</span>(x <span class="sc">-</span> tau)) <span class="sc">+</span> <span class="dv">1</span>)<span class="sc">^</span><span class="dv">3</span> <span class="sc">-</span> </span>
<span id="cb1-35"><a href="#cb1-35" aria-hidden="true" tabindex="-1"></a>       (r<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>r<span class="sc">*</span>(x <span class="sc">-</span> tau)))<span class="sc">/</span>(<span class="fu">exp</span>(<span class="sc">-</span>r<span class="sc">*</span>(x <span class="sc">-</span> tau)) <span class="sc">+</span> <span class="dv">1</span>)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb1-36"><a href="#cb1-36" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Now, let us make some graph to give an idea of how the dynamic changes with the parameters <span class="math inline">\(r\)</span> and <span class="math inline">\(tau\)</span>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──
✔ dplyr     1.1.2     ✔ readr     2.1.4
✔ forcats   1.0.0     ✔ stringr   1.5.0
✔ ggplot2   3.4.2     ✔ tibble    3.2.1
✔ lubridate 1.9.2     ✔ tidyr     1.3.0
✔ purrr     1.0.1     
── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
✖ dplyr::filter() masks stats::filter()
✖ dplyr::lag()    masks stats::lag()
ℹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors</code></pre>
</div>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(scales)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'scales'

The following object is masked from 'package:purrr':

    discard

The following object is masked from 'package:readr':

    col_factor</code></pre>
</div>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>g_legend<span class="ot">&lt;-</span><span class="cf">function</span>(a.gplot){</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>  tmp <span class="ot">&lt;-</span> <span class="fu">ggplot_gtable</span>(<span class="fu">ggplot_build</span>(a.gplot))</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>  leg <span class="ot">&lt;-</span> <span class="fu">which</span>(<span class="fu">sapply</span>(tmp<span class="sc">$</span>grobs, <span class="cf">function</span>(x) x<span class="sc">$</span>name) <span class="sc">==</span> <span class="st">"guide-box"</span>)</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>  legend <span class="ot">&lt;-</span> tmp<span class="sc">$</span>grobs[[leg]]</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(legend)}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The different values for <span class="math inline">\(r\)</span> and <span class="math inline">\(tau\)</span> (<span class="math inline">\(k\)</span> is set to 5000).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>situations <span class="ot">&lt;-</span> </span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">expand_grid</span>(<span class="at">tau =</span> <span class="fu">c</span>(<span class="dv">25</span>,<span class="dv">35</span>), <span class="at">r =</span> <span class="fu">c</span>(.<span class="dv">15</span>, .<span class="dv">25</span>, .<span class="dv">35</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">k =</span> <span class="dv">5000</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Let us apply, for a set of parameters, at different time horizon (from 0 to 60 by steps of .1) the logistic function, its first and second derivatives with respect to time. To do so, we define a “simulation” function:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co">#' Simulation of the logistic model for some parameters</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="co">#' </span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="co">#' @param i row number of situations</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>simu <span class="ot">&lt;-</span> <span class="cf">function</span>(i) {</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>  current_params <span class="ot">&lt;-</span> situations <span class="sc">|&gt;</span> <span class="fu">slice</span>(i)</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>  current_params <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">as_vector</span>(current_params)) <span class="sc">|&gt;</span> <span class="fu">as.list</span>()</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>  n     <span class="ot">&lt;-</span> <span class="dv">60</span></span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>  step  <span class="ot">&lt;-</span> .<span class="dv">01</span></span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>  sim   <span class="ot">&lt;-</span>  <span class="fu">logistic_f</span>(</span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">theta =</span> current_params, </span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="fu">seq</span>(<span class="dv">0</span>,n, <span class="at">by =</span> step)</span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a>  simD  <span class="ot">&lt;-</span>  <span class="fu">logistic_f_first_d</span>(</span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">theta =</span> current_params, </span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="fu">seq</span>(<span class="dv">0</span>,n, <span class="at">by =</span> step)</span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb8-18"><a href="#cb8-18" aria-hidden="true" tabindex="-1"></a>  simD2 <span class="ot">&lt;-</span>  <span class="fu">logistic_f_second_d</span>(</span>
<span id="cb8-19"><a href="#cb8-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">theta =</span> current_params, </span>
<span id="cb8-20"><a href="#cb8-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="fu">seq</span>(<span class="dv">0</span>,n, <span class="at">by =</span> step)</span>
<span id="cb8-21"><a href="#cb8-21" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb8-22"><a href="#cb8-22" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb8-23"><a href="#cb8-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(</span>
<span id="cb8-24"><a href="#cb8-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">t =</span> <span class="fu">seq</span>(<span class="dv">0</span>, n, <span class="at">by =</span> step),</span>
<span id="cb8-25"><a href="#cb8-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">k =</span> current_params[[<span class="st">"k"</span>]], </span>
<span id="cb8-26"><a href="#cb8-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">tau =</span> current_params[[<span class="st">"tau"</span>]],</span>
<span id="cb8-27"><a href="#cb8-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">r =</span> current_params[[<span class="st">"r"</span>]],</span>
<span id="cb8-28"><a href="#cb8-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">sim =</span> sim</span>
<span id="cb8-29"><a href="#cb8-29" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span> </span>
<span id="cb8-30"><a href="#cb8-30" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb8-31"><a href="#cb8-31" aria-hidden="true" tabindex="-1"></a>      <span class="at">simD =</span> simD,</span>
<span id="cb8-32"><a href="#cb8-32" aria-hidden="true" tabindex="-1"></a>      <span class="at">simD2 =</span> simD2</span>
<span id="cb8-33"><a href="#cb8-33" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb8-34"><a href="#cb8-34" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Let us do so for all the different sets of parameters:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>simu_res <span class="ot">&lt;-</span> <span class="fu">map_df</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(situations), simu)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We would like to show the thresholds on the graph:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>threshold_times <span class="ot">&lt;-</span> </span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>  simu_res <span class="sc">|&gt;</span> </span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(k, tau, r) <span class="sc">|&gt;</span> </span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">threshold_time =</span> <span class="fu">unique</span>(tau)) <span class="sc">|&gt;</span> </span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">|&gt;</span> </span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">r =</span> <span class="fu">str_c</span>(<span class="st">"$</span><span class="sc">\\</span><span class="st">r = "</span>, r, <span class="st">"$"</span>),</span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">tau =</span> <span class="fu">str_c</span>(<span class="st">"$</span><span class="sc">\\</span><span class="st">tau = "</span>, tau, <span class="st">"$"</span>)</span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'k', 'tau'. You can override using the
`.groups` argument.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>threshold_times</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 4
      k tau            r              threshold_time
  &lt;dbl&gt; &lt;chr&gt;          &lt;chr&gt;                   &lt;dbl&gt;
1  5000 "$\\tau = 25$" "$\\r = 0.15$"             25
2  5000 "$\\tau = 25$" "$\\r = 0.25$"             25
3  5000 "$\\tau = 25$" "$\\r = 0.35$"             25
4  5000 "$\\tau = 35$" "$\\r = 0.15$"             35
5  5000 "$\\tau = 35$" "$\\r = 0.25$"             35
6  5000 "$\\tau = 35$" "$\\r = 0.35$"             35</code></pre>
</div>
</div>
<p>Now, we are ready to create the plots:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>p_simu_logis <span class="ot">&lt;-</span> </span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span>  simu_res <span class="sc">|&gt;</span> </span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>      <span class="fu">mutate</span>(</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>        <span class="at">r =</span> <span class="fu">str_c</span>(<span class="st">"$</span><span class="sc">\\</span><span class="st">r = "</span>, r, <span class="st">"$"</span>),</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>        <span class="at">tau =</span> <span class="fu">str_c</span>(<span class="st">"$</span><span class="sc">\\</span><span class="st">tau = "</span>, tau, <span class="st">"$"</span>)</span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>      ),</span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> t)</span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">y =</span> sim, <span class="at">linetype =</span> <span class="st">"sim"</span>)) <span class="sc">+</span></span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">y =</span> simD<span class="sc">*</span><span class="dv">10</span>, <span class="at">linetype =</span> <span class="st">"simD"</span>)) <span class="sc">+</span></span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">y =</span> simD2<span class="sc">*</span><span class="dv">10</span>, <span class="at">linetype =</span> <span class="st">"simD2"</span>)) <span class="sc">+</span></span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(</span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> threshold_times, </span>
<span id="cb14-15"><a href="#cb14-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">xintercept =</span> threshold_time),</span>
<span id="cb14-16"><a href="#cb14-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">colour =</span> <span class="st">"red"</span>, <span class="at">linetype =</span> <span class="st">"dotted"</span>) <span class="sc">+</span></span>
<span id="cb14-17"><a href="#cb14-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(</span>
<span id="cb14-18"><a href="#cb14-18" aria-hidden="true" tabindex="-1"></a>    r<span class="sc">~</span>tau, </span>
<span id="cb14-19"><a href="#cb14-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">labeller =</span> <span class="fu">as_labeller</span>(</span>
<span id="cb14-20"><a href="#cb14-20" aria-hidden="true" tabindex="-1"></a>      latex2exp<span class="sc">::</span>TeX, </span>
<span id="cb14-21"><a href="#cb14-21" aria-hidden="true" tabindex="-1"></a>      <span class="at">default =</span> label_parsed</span>
<span id="cb14-22"><a href="#cb14-22" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb14-23"><a href="#cb14-23" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb14-24"><a href="#cb14-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Time"</span>, <span class="at">y =</span> latex2exp<span class="sc">::</span><span class="fu">TeX</span>(<span class="st">"$F(t)$"</span>)) <span class="sc">+</span></span>
<span id="cb14-25"><a href="#cb14-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(</span>
<span id="cb14-26"><a href="#cb14-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">labels =</span> scales<span class="sc">::</span>comma,</span>
<span id="cb14-27"><a href="#cb14-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">sec.axis =</span> <span class="fu">sec_axis</span>(</span>
<span id="cb14-28"><a href="#cb14-28" aria-hidden="true" tabindex="-1"></a>      <span class="sc">~</span>.<span class="sc">/</span><span class="dv">10</span>, </span>
<span id="cb14-29"><a href="#cb14-29" aria-hidden="true" tabindex="-1"></a>      <span class="at">name =</span> latex2exp<span class="sc">::</span><span class="fu">TeX</span>(</span>
<span id="cb14-30"><a href="#cb14-30" aria-hidden="true" tabindex="-1"></a>        <span class="st">"$</span><span class="sc">\\</span><span class="st">partial F(t) / </span><span class="sc">\\</span><span class="st">partial t$, $</span><span class="sc">\\</span><span class="st">partial^2 F(t) / </span><span class="sc">\\</span><span class="st">partial t^2$"</span></span>
<span id="cb14-31"><a href="#cb14-31" aria-hidden="true" tabindex="-1"></a>      ),</span>
<span id="cb14-32"><a href="#cb14-32" aria-hidden="true" tabindex="-1"></a>      <span class="at">labels =</span> comma)) <span class="sc">+</span></span>
<span id="cb14-33"><a href="#cb14-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_linetype_manual</span>(</span>
<span id="cb14-34"><a href="#cb14-34" aria-hidden="true" tabindex="-1"></a>    <span class="cn">NULL</span>,</span>
<span id="cb14-35"><a href="#cb14-35" aria-hidden="true" tabindex="-1"></a>    <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"sim"</span> <span class="ot">=</span> <span class="st">"solid"</span>, <span class="st">"simD"</span> <span class="ot">=</span> <span class="st">"dashed"</span>, <span class="st">"simD2"</span> <span class="ot">=</span> <span class="st">"dotdash"</span>),</span>
<span id="cb14-36"><a href="#cb14-36" aria-hidden="true" tabindex="-1"></a>    <span class="at">labels =</span> <span class="fu">c</span>(</span>
<span id="cb14-37"><a href="#cb14-37" aria-hidden="true" tabindex="-1"></a>      <span class="st">"sim"</span> <span class="ot">=</span> latex2exp<span class="sc">::</span><span class="fu">TeX</span>(<span class="st">"$F(t)$"</span>), </span>
<span id="cb14-38"><a href="#cb14-38" aria-hidden="true" tabindex="-1"></a>      <span class="st">"simD"</span> <span class="ot">=</span> latex2exp<span class="sc">::</span><span class="fu">TeX</span>(<span class="st">"$</span><span class="sc">\\</span><span class="st">partial F(t) / </span><span class="sc">\\</span><span class="st">partial t$"</span>),</span>
<span id="cb14-39"><a href="#cb14-39" aria-hidden="true" tabindex="-1"></a>      <span class="st">"simD2"</span> <span class="ot">=</span> latex2exp<span class="sc">::</span><span class="fu">TeX</span>(<span class="st">"$</span><span class="sc">\\</span><span class="st">partial^2 F(t) / </span><span class="sc">\\</span><span class="st">partial t^2$"</span>))) <span class="sc">+</span></span>
<span id="cb14-40"><a href="#cb14-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.ticks.y =</span> <span class="fu">element_blank</span>())</span>
<span id="cb14-41"><a href="#cb14-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-42"><a href="#cb14-42" aria-hidden="true" tabindex="-1"></a>p_simu_logis <span class="sc">+</span></span>
<span id="cb14-43"><a href="#cb14-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb14-44"><a href="#cb14-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-illustration-logistic-model" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="phenomeological-background_files/figure-html/fig-illustration-logistic-model-1.png" class="img-fluid figure-img" width="672"></p>
<p></p><figcaption class="figure-caption">Figure&nbsp;6.1: Illustration of the logistic model for different values for <span class="math inline">\(\tau\)</span> and <span class="math inline">\(r\)</span>, with <span class="math inline">\(k=5,000\)</span></figcaption><p></p>
</figure>
</div>
</div>
</div>
<section id="key-moments" class="level4" data-number="6.1.2.1">
<h4 data-number="6.1.2.1" class="anchored" data-anchor-id="key-moments"><span class="header-section-number">6.1.2.1</span> Key moments</h4>
<p>Let us focus on the key moment of the epidemics. Let us illustrate them using one of the scenarios.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>data_sim <span class="ot">&lt;-</span> <span class="fu">simu</span>(<span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The starting point:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>df_starting <span class="ot">&lt;-</span> </span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>  data_sim <span class="sc">%&gt;%</span> </span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(sim <span class="sc">&gt;=</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice</span>(<span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The acceleration point</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>df_acceleration <span class="ot">&lt;-</span> </span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>  data_sim <span class="sc">%&gt;%</span> </span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(simD2 <span class="sc">==</span> <span class="fu">max</span>(simD2)) <span class="sc">%&gt;%</span> </span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice</span>(<span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The peak:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>df_peak <span class="ot">&lt;-</span> </span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>  data_sim <span class="sc">%&gt;%</span> </span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(simD <span class="sc">==</span> <span class="fu">max</span>(simD)) <span class="sc">%&gt;%</span> </span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice</span>(<span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The deceleration point:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>df_deceleration <span class="ot">&lt;-</span> </span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>  data_sim <span class="sc">%&gt;%</span> </span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(simD2 <span class="sc">==</span> <span class="fu">min</span>(simD2)) <span class="sc">%&gt;%</span> </span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice</span>(<span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The return point:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>df_return <span class="ot">&lt;-</span> </span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>  data_sim <span class="sc">%&gt;%</span> </span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(sim <span class="sc">&gt;</span> k <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice</span>(<span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Let us reshape the data:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>df_plot_key_moments <span class="ot">&lt;-</span> </span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>  data_sim <span class="sc">%&gt;%</span> </span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gather</span>(key, value, sim, simD, simD2)</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>df_plot_key_moments_points <span class="ot">&lt;-</span> </span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>  df_acceleration <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">label =</span> <span class="st">"$t_A$"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_rows</span>(df_peak <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">label =</span> <span class="st">"$t_P$"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_rows</span>(df_deceleration <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">label =</span> <span class="st">"$t_D$"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>And the plot:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>p_key_moments <span class="ot">&lt;-</span> </span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">col =</span> <span class="st">"grey"</span>) <span class="sc">+</span></span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(</span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> df_plot_key_moments,</span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> t, <span class="at">y =</span> value, <span class="at">linetype =</span> key)</span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(</span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> df_plot_key_moments_points,</span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> t, <span class="at">xend =</span> t, <span class="at">y =</span> <span class="dv">0</span>, <span class="at">yend =</span> sim),</span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">linetype =</span> <span class="st">"dotted"</span>, <span class="at">colour =</span> <span class="st">"red"</span></span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb22-13"><a href="#cb22-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(</span>
<span id="cb22-14"><a href="#cb22-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> df_plot_key_moments_points,</span>
<span id="cb22-15"><a href="#cb22-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> t, <span class="at">y =</span> sim), <span class="at">size =</span> <span class="dv">2</span></span>
<span id="cb22-16"><a href="#cb22-16" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb22-17"><a href="#cb22-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(</span>
<span id="cb22-18"><a href="#cb22-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> df_plot_key_moments_points,</span>
<span id="cb22-19"><a href="#cb22-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> t, <span class="at">y =</span> sim),</span>
<span id="cb22-20"><a href="#cb22-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> <span class="dv">1</span>, <span class="at">colour =</span> <span class="st">"white"</span></span>
<span id="cb22-21"><a href="#cb22-21" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb22-22"><a href="#cb22-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(</span>
<span id="cb22-23"><a href="#cb22-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> df_plot_key_moments_points,</span>
<span id="cb22-24"><a href="#cb22-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> t<span class="dv">-2</span>, <span class="at">y =</span> sim <span class="sc">+</span> .<span class="dv">05</span><span class="sc">*</span>k, <span class="at">label =</span> label)</span>
<span id="cb22-25"><a href="#cb22-25" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb22-26"><a href="#cb22-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Time"</span>, <span class="at">y =</span> latex2exp<span class="sc">::</span><span class="fu">TeX</span>(<span class="st">"$F(t)$"</span>)) <span class="sc">+</span></span>
<span id="cb22-27"><a href="#cb22-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_linetype_manual</span>(</span>
<span id="cb22-28"><a href="#cb22-28" aria-hidden="true" tabindex="-1"></a>    <span class="cn">NULL</span>,</span>
<span id="cb22-29"><a href="#cb22-29" aria-hidden="true" tabindex="-1"></a>    <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"sim"</span> <span class="ot">=</span> <span class="st">"solid"</span>, <span class="st">"simD"</span> <span class="ot">=</span> <span class="st">"dashed"</span>, <span class="st">"simD2"</span> <span class="ot">=</span> <span class="st">"dotdash"</span>),</span>
<span id="cb22-30"><a href="#cb22-30" aria-hidden="true" tabindex="-1"></a>    <span class="at">labels =</span> <span class="fu">c</span>(</span>
<span id="cb22-31"><a href="#cb22-31" aria-hidden="true" tabindex="-1"></a>      <span class="st">"sim"</span> <span class="ot">=</span> latex2exp<span class="sc">::</span><span class="fu">TeX</span>(<span class="st">"$F(t)$"</span>),</span>
<span id="cb22-32"><a href="#cb22-32" aria-hidden="true" tabindex="-1"></a>      <span class="st">"simD"</span> <span class="ot">=</span> latex2exp<span class="sc">::</span><span class="fu">TeX</span>(<span class="st">"$</span><span class="sc">\\</span><span class="st">partial F(t) / </span><span class="sc">\\</span><span class="st">partial t$"</span>),</span>
<span id="cb22-33"><a href="#cb22-33" aria-hidden="true" tabindex="-1"></a>      <span class="st">"simD2"</span> <span class="ot">=</span> latex2exp<span class="sc">::</span><span class="fu">TeX</span>(<span class="st">"$</span><span class="sc">\\</span><span class="st">partial^2 F(t) / </span><span class="sc">\\</span><span class="st">partial t^2$"</span>)</span>
<span id="cb22-34"><a href="#cb22-34" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb22-35"><a href="#cb22-35" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb22-36"><a href="#cb22-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text =</span> <span class="fu">element_blank</span>(), <span class="at">axis.ticks =</span> <span class="fu">element_blank</span>())</span>
<span id="cb22-37"><a href="#cb22-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-38"><a href="#cb22-38" aria-hidden="true" tabindex="-1"></a>p_key_moments</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-illustration-key-moments-logistic" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="phenomeological-background_files/figure-html/fig-illustration-key-moments-logistic-1.png" class="img-fluid figure-img" width="672"></p>
<p></p><figcaption class="figure-caption">Figure&nbsp;6.2: Key moments of the epidemics, using a logistim model.</figcaption><p></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="gompertz-model" class="level3" data-number="6.1.3">
<h3 data-number="6.1.3" class="anchored" data-anchor-id="gompertz-model"><span class="header-section-number">6.1.3</span> Gompertz Model</h3>
<p>The Gompertz model <span class="citation" data-cites="gompertz_nature_1825">(<a href="references.html#ref-gompertz_nature_1825" role="doc-biblioref">Gompertz 1825</a>)</span> has three parameters, but corresponds to alternative restrictions with <span class="math inline">\(\alpha=1\)</span> but this time <span class="math inline">\(\delta=0\)</span>. The solution to <a href="#eq-leqbase">Equation&nbsp;<span>6.1</span></a> can be written as follows <span class="citation" data-cites="tjorve_use_2017">Tjørve and Tjørve (<a href="references.html#ref-tjorve_use_2017" role="doc-biblioref">2017</a>)</span>: <span id="eq-gom"><span class="math display">\[
C(t) = K \exp\left[ -\exp \left(-r(t-\tau) \right)\right].
\tag{6.4}\]</span></span> In <a href="#eq-gom">Equation&nbsp;<span>6.4</span></a>, the parameters are interpreted in the same way as those of the logistic model. The main difference between the logistic and Gompertz models is that the latter is not symmetric around the inflection point, which now appears earlier as <span class="math inline">\(C(\tau) = K/e\)</span>. The first order derivative of this function provides an estimate of the number of cases at each point in time: <span class="math display">\[
\frac{\partial C(t)}{\partial t} = K r\exp\left[r(\tau-t) - \exp\left(r(\tau-t)\right)\right].
\]</span> So that the relative speed of the epidemic is given by: <span class="math display">\[
\frac{c(t)}{C(t)} = r e^{-r(t-\tau)},
\]</span> with of course a maximum speed at the peak.</p>
<p>In R, this translates to:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="co">#' Gompertz function with three parameters</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a><span class="co">#' </span></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a><span class="co">#' @param theta vector of named parameters</span></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a><span class="co">#' @param x time</span></span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>gompertz_f <span class="ot">&lt;-</span> <span class="cf">function</span>(theta, x) {</span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>  k <span class="ot">&lt;-</span> theta[[<span class="st">"k"</span>]]</span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>  tau <span class="ot">&lt;-</span> theta[[<span class="st">"tau"</span>]]</span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a>  r <span class="ot">&lt;-</span> theta[[<span class="st">"r"</span>]]</span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a>  k<span class="sc">*</span><span class="fu">exp</span>( <span class="sc">-</span><span class="fu">exp</span>( <span class="sc">-</span>r <span class="sc">*</span> (x <span class="sc">-</span> tau) ) )</span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a><span class="co">#' First order derivative of Gompertz wrt x</span></span>
<span id="cb23-12"><a href="#cb23-12" aria-hidden="true" tabindex="-1"></a><span class="co">#' </span></span>
<span id="cb23-13"><a href="#cb23-13" aria-hidden="true" tabindex="-1"></a><span class="co">#' @param theta vector of named parameters</span></span>
<span id="cb23-14"><a href="#cb23-14" aria-hidden="true" tabindex="-1"></a><span class="co">#' @param x time</span></span>
<span id="cb23-15"><a href="#cb23-15" aria-hidden="true" tabindex="-1"></a>gompertz_f_first_d <span class="ot">&lt;-</span> <span class="cf">function</span>(theta, x) {</span>
<span id="cb23-16"><a href="#cb23-16" aria-hidden="true" tabindex="-1"></a>  k <span class="ot">&lt;-</span> theta[[<span class="st">"k"</span>]]</span>
<span id="cb23-17"><a href="#cb23-17" aria-hidden="true" tabindex="-1"></a>  tau <span class="ot">&lt;-</span> theta[[<span class="st">"tau"</span>]]</span>
<span id="cb23-18"><a href="#cb23-18" aria-hidden="true" tabindex="-1"></a>  r <span class="ot">&lt;-</span> theta[[<span class="st">"r"</span>]]</span>
<span id="cb23-19"><a href="#cb23-19" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb23-20"><a href="#cb23-20" aria-hidden="true" tabindex="-1"></a>  k <span class="sc">*</span> (x <span class="sc">-</span> tau) <span class="sc">*</span> <span class="fu">exp</span>(r <span class="sc">*</span> (tau <span class="sc">-</span> x) <span class="sc">-</span> <span class="fu">exp</span>(r <span class="sc">*</span> (tau <span class="sc">-</span> x)))</span>
<span id="cb23-21"><a href="#cb23-21" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb23-22"><a href="#cb23-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-23"><a href="#cb23-23" aria-hidden="true" tabindex="-1"></a><span class="co">#' Second order derivative of Gompertz</span></span>
<span id="cb23-24"><a href="#cb23-24" aria-hidden="true" tabindex="-1"></a><span class="co">#' </span></span>
<span id="cb23-25"><a href="#cb23-25" aria-hidden="true" tabindex="-1"></a><span class="co">#' @param theta vector of named parameters</span></span>
<span id="cb23-26"><a href="#cb23-26" aria-hidden="true" tabindex="-1"></a><span class="co">#' @param x time</span></span>
<span id="cb23-27"><a href="#cb23-27" aria-hidden="true" tabindex="-1"></a>gompertz_f_second_d <span class="ot">&lt;-</span> <span class="cf">function</span>(theta, x) {</span>
<span id="cb23-28"><a href="#cb23-28" aria-hidden="true" tabindex="-1"></a>  k <span class="ot">&lt;-</span> theta[[<span class="st">"k"</span>]]</span>
<span id="cb23-29"><a href="#cb23-29" aria-hidden="true" tabindex="-1"></a>  tau <span class="ot">&lt;-</span> theta[[<span class="st">"tau"</span>]]</span>
<span id="cb23-30"><a href="#cb23-30" aria-hidden="true" tabindex="-1"></a>  r <span class="ot">&lt;-</span> theta[[<span class="st">"r"</span>]]</span>
<span id="cb23-31"><a href="#cb23-31" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb23-32"><a href="#cb23-32" aria-hidden="true" tabindex="-1"></a>  <span class="sc">-</span>k <span class="sc">*</span> r<span class="sc">^</span><span class="dv">2</span> <span class="sc">*</span> <span class="fu">exp</span>(<span class="sc">-</span>r <span class="sc">*</span> (x <span class="sc">-</span> tau)) <span class="sc">*</span> </span>
<span id="cb23-33"><a href="#cb23-33" aria-hidden="true" tabindex="-1"></a>    <span class="fu">exp</span>(<span class="sc">-</span><span class="fu">exp</span>(<span class="sc">-</span>r <span class="sc">*</span> (x <span class="sc">-</span> tau))) <span class="sc">+</span> </span>
<span id="cb23-34"><a href="#cb23-34" aria-hidden="true" tabindex="-1"></a>    k <span class="sc">*</span> r<span class="sc">^</span><span class="dv">2</span> <span class="sc">*</span> (<span class="fu">exp</span>(<span class="sc">-</span>r <span class="sc">*</span> (x <span class="sc">-</span> tau)))<span class="sc">^</span><span class="dv">2</span> <span class="sc">*</span> <span class="fu">exp</span>(<span class="sc">-</span><span class="fu">exp</span>(<span class="sc">-</span>r <span class="sc">*</span> (x <span class="sc">-</span> tau)))</span>
<span id="cb23-35"><a href="#cb23-35" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Let us make some graph to give an idea of how the dynamic changes with the parameters <span class="math inline">\(r\)</span> and <span class="math inline">\(tau\)</span>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>k <span class="ot">&lt;-</span> <span class="dv">5000</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>situations <span class="ot">&lt;-</span> </span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">expand_grid</span>(<span class="at">tau =</span> <span class="fu">c</span>(<span class="dv">25</span>,<span class="dv">35</span>), <span class="at">r =</span> <span class="fu">c</span>(.<span class="dv">15</span>, .<span class="dv">25</span>, .<span class="dv">35</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">k =</span> k)</span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a><span class="co">#' Simulation of the logistic model for some parameters</span></span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a><span class="co">#' </span></span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a><span class="co">#' @param i row number of situations</span></span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a>simu_gomp <span class="ot">&lt;-</span> <span class="cf">function</span>(i) {</span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a>  current_params <span class="ot">&lt;-</span> situations <span class="sc">|&gt;</span> <span class="fu">slice</span>(i)</span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a>  current_params <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">as_vector</span>(current_params)) <span class="sc">|&gt;</span> <span class="fu">as.list</span>()</span>
<span id="cb24-12"><a href="#cb24-12" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb24-13"><a href="#cb24-13" aria-hidden="true" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="dv">60</span></span>
<span id="cb24-14"><a href="#cb24-14" aria-hidden="true" tabindex="-1"></a>  step <span class="ot">&lt;-</span> .<span class="dv">01</span></span>
<span id="cb24-15"><a href="#cb24-15" aria-hidden="true" tabindex="-1"></a>  sim <span class="ot">&lt;-</span>  <span class="fu">gompertz_f</span>(<span class="at">theta =</span> current_params, <span class="at">x =</span> <span class="fu">seq</span>(<span class="dv">1</span>,n, <span class="at">by =</span> step))</span>
<span id="cb24-16"><a href="#cb24-16" aria-hidden="true" tabindex="-1"></a>  simD <span class="ot">&lt;-</span>  <span class="fu">gompertz_f_first_d</span>(<span class="at">theta =</span> current_params, <span class="at">x =</span> <span class="fu">seq</span>(<span class="dv">1</span>,n, <span class="at">by =</span> step))</span>
<span id="cb24-17"><a href="#cb24-17" aria-hidden="true" tabindex="-1"></a>  simD2 <span class="ot">&lt;-</span>  <span class="fu">gompertz_f_second_d</span>(<span class="at">theta =</span> current_params, <span class="at">x =</span> <span class="fu">seq</span>(<span class="dv">1</span>,n, <span class="at">by =</span> step))</span>
<span id="cb24-18"><a href="#cb24-18" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb24-19"><a href="#cb24-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(</span>
<span id="cb24-20"><a href="#cb24-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">t =</span> <span class="fu">seq</span>(<span class="dv">1</span>, n, <span class="at">by =</span> step),</span>
<span id="cb24-21"><a href="#cb24-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">k =</span> current_params[[<span class="st">"k"</span>]],</span>
<span id="cb24-22"><a href="#cb24-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">tau =</span> current_params[[<span class="st">"tau"</span>]],</span>
<span id="cb24-23"><a href="#cb24-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">r =</span> current_params[[<span class="st">"r"</span>]],</span>
<span id="cb24-24"><a href="#cb24-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">sim =</span> sim) <span class="sc">|&gt;</span> </span>
<span id="cb24-25"><a href="#cb24-25" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">simD =</span> simD,</span>
<span id="cb24-26"><a href="#cb24-26" aria-hidden="true" tabindex="-1"></a>           <span class="at">simD2 =</span> simD2)</span>
<span id="cb24-27"><a href="#cb24-27" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb24-28"><a href="#cb24-28" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The values of <span class="math inline">\(C(t)\)</span>, its first and second derivatives with respect to time can be computed for the different scenarios:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>simu_gomp_res <span class="ot">&lt;-</span> <span class="fu">map_df</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(situations), simu_gomp)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The threshold for each scenario:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>threshold_times <span class="ot">&lt;-</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>  simu_gomp_res <span class="sc">|&gt;</span></span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(k, tau, r) <span class="sc">|&gt;</span></span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">threshold_time =</span> <span class="fu">unique</span>(tau)) <span class="sc">|&gt;</span></span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">|&gt;</span> </span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">r =</span> <span class="fu">str_c</span>(<span class="st">"$</span><span class="sc">\\</span><span class="st">r = "</span>, r, <span class="st">"$"</span>),</span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">tau =</span> <span class="fu">str_c</span>(<span class="st">"$</span><span class="sc">\\</span><span class="st">tau = "</span>, tau, <span class="st">"$"</span>)</span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'k', 'tau'. You can override using the
`.groups` argument.</code></pre>
</div>
</div>
<p>And we can plot the results:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>p_simu_gomp <span class="ot">&lt;-</span> </span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> simu_gomp_res <span class="sc">|&gt;</span> </span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>      <span class="at">r =</span> <span class="fu">str_c</span>(<span class="st">"$</span><span class="sc">\\</span><span class="st">r = "</span>, r, <span class="st">"$"</span>),</span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a>      <span class="at">tau =</span> <span class="fu">str_c</span>(<span class="st">"$</span><span class="sc">\\</span><span class="st">tau = "</span>, tau, <span class="st">"$"</span>)</span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> t)) <span class="sc">+</span></span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">y =</span> sim, <span class="at">linetype =</span> <span class="st">"sim"</span>)) <span class="sc">+</span></span>
<span id="cb28-10"><a href="#cb28-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">y =</span> simD, <span class="at">linetype =</span> <span class="st">"simD"</span>)) <span class="sc">+</span></span>
<span id="cb28-11"><a href="#cb28-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">y =</span> simD2, <span class="at">linetype =</span> <span class="st">"simD2"</span>)) <span class="sc">+</span></span>
<span id="cb28-12"><a href="#cb28-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(</span>
<span id="cb28-13"><a href="#cb28-13" aria-hidden="true" tabindex="-1"></a>    r<span class="sc">~</span>tau,</span>
<span id="cb28-14"><a href="#cb28-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">labeller =</span> <span class="fu">as_labeller</span>(</span>
<span id="cb28-15"><a href="#cb28-15" aria-hidden="true" tabindex="-1"></a>      latex2exp<span class="sc">::</span>TeX, </span>
<span id="cb28-16"><a href="#cb28-16" aria-hidden="true" tabindex="-1"></a>      <span class="at">default =</span> label_parsed</span>
<span id="cb28-17"><a href="#cb28-17" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb28-18"><a href="#cb28-18" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb28-19"><a href="#cb28-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(</span>
<span id="cb28-20"><a href="#cb28-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> threshold_times, </span>
<span id="cb28-21"><a href="#cb28-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">xintercept =</span> threshold_time), </span>
<span id="cb28-22"><a href="#cb28-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">colour =</span> <span class="st">"red"</span>, <span class="at">linetype =</span> <span class="st">"dotted"</span>) <span class="sc">+</span></span>
<span id="cb28-23"><a href="#cb28-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Time"</span>, <span class="at">y =</span> latex2exp<span class="sc">::</span><span class="fu">TeX</span>(<span class="st">"$F(t)$"</span>)) <span class="sc">+</span></span>
<span id="cb28-24"><a href="#cb28-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_linetype_manual</span>(</span>
<span id="cb28-25"><a href="#cb28-25" aria-hidden="true" tabindex="-1"></a>    <span class="cn">NULL</span>,</span>
<span id="cb28-26"><a href="#cb28-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"sim"</span> <span class="ot">=</span> <span class="st">"solid"</span>, <span class="st">"simD"</span> <span class="ot">=</span> <span class="st">"dashed"</span>, <span class="st">"simD2"</span> <span class="ot">=</span> <span class="st">"dotdash"</span>),</span>
<span id="cb28-27"><a href="#cb28-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"sim"</span> <span class="ot">=</span> latex2exp<span class="sc">::</span><span class="fu">TeX</span>(<span class="st">"$F(t)$"</span>),</span>
<span id="cb28-28"><a href="#cb28-28" aria-hidden="true" tabindex="-1"></a>               <span class="st">"simD"</span> <span class="ot">=</span> latex2exp<span class="sc">::</span><span class="fu">TeX</span>(<span class="st">"$</span><span class="sc">\\</span><span class="st">partial F(t) / </span><span class="sc">\\</span><span class="st">partial t$"</span>),</span>
<span id="cb28-29"><a href="#cb28-29" aria-hidden="true" tabindex="-1"></a>               <span class="st">"simD2"</span> <span class="ot">=</span> latex2exp<span class="sc">::</span><span class="fu">TeX</span>(<span class="st">"$</span><span class="sc">\\</span><span class="st">partial^2 F(t) / </span><span class="sc">\\</span><span class="st">partial t^2$"</span>)</span>
<span id="cb28-30"><a href="#cb28-30" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb28-31"><a href="#cb28-31" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb28-32"><a href="#cb28-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.ticks.y =</span> <span class="fu">element_blank</span>())</span>
<span id="cb28-33"><a href="#cb28-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-34"><a href="#cb28-34" aria-hidden="true" tabindex="-1"></a>p_simu_gomp <span class="sc">+</span></span>
<span id="cb28-35"><a href="#cb28-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb28-36"><a href="#cb28-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-illustration-gompertz-model" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="phenomeological-background_files/figure-html/fig-illustration-gompertz-model-1.png" class="img-fluid figure-img" width="672"></p>
<p></p><figcaption class="figure-caption">Figure&nbsp;6.3: Illustration of Gompertz model for different values for <span class="math inline">\(\tau\)</span> and <span class="math inline">\(r\)</span>, with <span class="math inline">\(k=5,000\)</span></figcaption><p></p>
</figure>
</div>
</div>
</div>
</section>
<section id="richards-model" class="level3" data-number="6.1.4">
<h3 data-number="6.1.4" class="anchored" data-anchor-id="richards-model"><span class="header-section-number">6.1.4</span> Richards Model</h3>
<p>The question “what happens with <span class="math inline">\(0&lt;\delta&lt;1\)</span>” finds an answer with <span class="citation" data-cites="richards_flexible_1959">Richards (<a href="references.html#ref-richards_flexible_1959" role="doc-biblioref">1959</a>)</span> and the Richards model which is widely used in nonlinear regression analysis. The solution to <a href="#eq-leqbase">Equation&nbsp;<span>6.1</span></a> provided in <span class="citation" data-cites="lee_estimation_2020">Lee, Lei, and Mallick (<a href="references.html#ref-lee_estimation_2020" role="doc-biblioref">2020</a>)</span> corresponds to: <span class="math display">\[
C(t) = K\left[ 1 + \delta\exp\left( -r (t-\tau)\right)\right]^{-1/\delta},
\]</span> where parameters <span class="math inline">\(K\)</span> and <span class="math inline">\(\tau\)</span> and are interpreted in the same way as those of the logistic and Gompertz models, while the growth rate is now <span class="math inline">\(r/\delta\)</span>. The parameter <span class="math inline">\(\delta&gt;0\)</span> is used to control the value of the curve at the inflection point <span class="math inline">\(C(\tau) = K/(1+\delta)^{1/\delta}\)</span>, and thus the asymmetry around <span class="math inline">\(t = \tau\)</span>. This model considers one more parameter than the Gompertz model to model this asymmetry. The first order derivative of this function will provide an estimate of the number of cases at each point in time: <span class="math display">\[
\frac{\partial C(t)}{\partial t} =  \frac{K r\left[\delta\exp\left(r(\tau-t)\right)+1 \right]^{-1/\delta}}{\delta+\exp\left(r(t-\tau)\right)},
\]</span> leading to a relative speed of: <span class="math display">\[
\frac{c(t)}{C(t)} = r \frac{e^{-r(t-\tau)}}{1+\delta e^{-r(t-\tau)}}.
\]</span> This model is also a generalization of the two previous ones as can be seen for instance when comparing the different relative speeds.</p>
<p>In R, this translates to the following functions:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="co">#' Richards function with four parameters</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a><span class="co">#' </span></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a><span class="co">#' @param theta vector of named parameters</span></span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a><span class="co">#' @param x time</span></span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>richards_f <span class="ot">&lt;-</span> <span class="cf">function</span>(theta, x) {</span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a>  k <span class="ot">&lt;-</span> theta[[<span class="st">"k"</span>]]</span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a>  tau <span class="ot">&lt;-</span> theta[[<span class="st">"tau"</span>]]</span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a>  r <span class="ot">&lt;-</span> theta[[<span class="st">"r"</span>]]</span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a>  delta <span class="ot">&lt;-</span> theta[[<span class="st">"delta"</span>]]</span>
<span id="cb29-10"><a href="#cb29-10" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb29-11"><a href="#cb29-11" aria-hidden="true" tabindex="-1"></a>  k <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">+</span> delta <span class="sc">*</span> <span class="fu">exp</span>(<span class="sc">-</span>r <span class="sc">*</span> delta <span class="sc">*</span> (x <span class="sc">-</span> tau)))<span class="sc">^</span>(<span class="dv">1</span> <span class="sc">/</span> delta)</span>
<span id="cb29-12"><a href="#cb29-12" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb29-13"><a href="#cb29-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-14"><a href="#cb29-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-15"><a href="#cb29-15" aria-hidden="true" tabindex="-1"></a><span class="co">#' First order derivative of Richards function wrt time (x)</span></span>
<span id="cb29-16"><a href="#cb29-16" aria-hidden="true" tabindex="-1"></a><span class="co">#' </span></span>
<span id="cb29-17"><a href="#cb29-17" aria-hidden="true" tabindex="-1"></a><span class="co">#' @param theta vector of named parameters</span></span>
<span id="cb29-18"><a href="#cb29-18" aria-hidden="true" tabindex="-1"></a><span class="co">#' @param x time</span></span>
<span id="cb29-19"><a href="#cb29-19" aria-hidden="true" tabindex="-1"></a>richards_f_first_d <span class="ot">&lt;-</span> <span class="cf">function</span>(theta, x) {</span>
<span id="cb29-20"><a href="#cb29-20" aria-hidden="true" tabindex="-1"></a>  k <span class="ot">&lt;-</span> theta[[<span class="st">"k"</span>]]</span>
<span id="cb29-21"><a href="#cb29-21" aria-hidden="true" tabindex="-1"></a>  tau <span class="ot">&lt;-</span> theta[[<span class="st">"tau"</span>]]</span>
<span id="cb29-22"><a href="#cb29-22" aria-hidden="true" tabindex="-1"></a>  r <span class="ot">&lt;-</span> theta[[<span class="st">"r"</span>]]</span>
<span id="cb29-23"><a href="#cb29-23" aria-hidden="true" tabindex="-1"></a>  delta <span class="ot">&lt;-</span> theta[[<span class="st">"delta"</span>]]</span>
<span id="cb29-24"><a href="#cb29-24" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb29-25"><a href="#cb29-25" aria-hidden="true" tabindex="-1"></a>  delta <span class="sc">*</span> k <span class="sc">*</span> r <span class="sc">*</span> <span class="fu">exp</span>(delta <span class="sc">*</span> (<span class="sc">-</span>r) <span class="sc">*</span> (x <span class="sc">-</span> tau)) <span class="sc">*</span> </span>
<span id="cb29-26"><a href="#cb29-26" aria-hidden="true" tabindex="-1"></a>    (delta <span class="sc">*</span> <span class="fu">exp</span>(delta <span class="sc">*</span> (<span class="sc">-</span>r) <span class="sc">*</span> (x <span class="sc">-</span> tau)) <span class="sc">+</span> <span class="dv">1</span>)<span class="sc">^</span>(<span class="sc">-</span><span class="dv">1</span> <span class="sc">/</span> delta <span class="sc">-</span> <span class="dv">1</span>)</span>
<span id="cb29-27"><a href="#cb29-27" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb29-28"><a href="#cb29-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-29"><a href="#cb29-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-30"><a href="#cb29-30" aria-hidden="true" tabindex="-1"></a><span class="co">#' Second order derivative of Richards function wrt time (x)</span></span>
<span id="cb29-31"><a href="#cb29-31" aria-hidden="true" tabindex="-1"></a><span class="co">#' </span></span>
<span id="cb29-32"><a href="#cb29-32" aria-hidden="true" tabindex="-1"></a><span class="co">#' @param theta vector of named parameters</span></span>
<span id="cb29-33"><a href="#cb29-33" aria-hidden="true" tabindex="-1"></a><span class="co">#' @param x time</span></span>
<span id="cb29-34"><a href="#cb29-34" aria-hidden="true" tabindex="-1"></a>richards_f_second_d <span class="ot">&lt;-</span> <span class="cf">function</span>(theta, x) {</span>
<span id="cb29-35"><a href="#cb29-35" aria-hidden="true" tabindex="-1"></a>  k <span class="ot">&lt;-</span> theta[[<span class="st">"k"</span>]]</span>
<span id="cb29-36"><a href="#cb29-36" aria-hidden="true" tabindex="-1"></a>  tau <span class="ot">&lt;-</span> theta[[<span class="st">"tau"</span>]]</span>
<span id="cb29-37"><a href="#cb29-37" aria-hidden="true" tabindex="-1"></a>  r <span class="ot">&lt;-</span> theta[[<span class="st">"r"</span>]]</span>
<span id="cb29-38"><a href="#cb29-38" aria-hidden="true" tabindex="-1"></a>  delta <span class="ot">&lt;-</span> theta[[<span class="st">"delta"</span>]]</span>
<span id="cb29-39"><a href="#cb29-39" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb29-40"><a href="#cb29-40" aria-hidden="true" tabindex="-1"></a>  k <span class="sc">*</span> ((<span class="sc">-</span><span class="dv">1</span> <span class="sc">/</span> delta <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">*</span> </span>
<span id="cb29-41"><a href="#cb29-41" aria-hidden="true" tabindex="-1"></a>         delta<span class="sc">^</span><span class="dv">3</span> <span class="sc">*</span> r<span class="sc">^</span><span class="dv">2</span> <span class="sc">*</span> (<span class="sc">-</span><span class="fu">exp</span>(<span class="sc">-</span><span class="dv">2</span> <span class="sc">*</span> delta <span class="sc">*</span> r <span class="sc">*</span> (x <span class="sc">-</span> tau))) <span class="sc">*</span></span>
<span id="cb29-42"><a href="#cb29-42" aria-hidden="true" tabindex="-1"></a>         (delta <span class="sc">*</span> <span class="fu">exp</span>(delta <span class="sc">*</span> (<span class="sc">-</span>r) <span class="sc">*</span> (x <span class="sc">-</span> tau)) <span class="sc">+</span> <span class="dv">1</span>)<span class="sc">^</span>(<span class="sc">-</span><span class="dv">1</span> <span class="sc">/</span> delta <span class="sc">-</span> <span class="dv">2</span>) <span class="sc">-</span> </span>
<span id="cb29-43"><a href="#cb29-43" aria-hidden="true" tabindex="-1"></a>         delta<span class="sc">^</span><span class="dv">2</span> <span class="sc">*</span> r<span class="sc">^</span><span class="dv">2</span> <span class="sc">*</span> <span class="fu">exp</span>(delta <span class="sc">*</span> (<span class="sc">-</span>r) <span class="sc">*</span> (x <span class="sc">-</span> tau)) <span class="sc">*</span> </span>
<span id="cb29-44"><a href="#cb29-44" aria-hidden="true" tabindex="-1"></a>         (delta <span class="sc">*</span> <span class="fu">exp</span>(delta <span class="sc">*</span> (<span class="sc">-</span>r) <span class="sc">*</span> (x <span class="sc">-</span> tau)) <span class="sc">+</span> <span class="dv">1</span>)<span class="sc">^</span>(<span class="sc">-</span><span class="dv">1</span> <span class="sc">/</span> delta <span class="sc">-</span> <span class="dv">1</span>))</span>
<span id="cb29-45"><a href="#cb29-45" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Again, let us provide different scenarios to plot the curves for <span class="math inline">\(C(t)\)</span>, its first and second derivatives with respect to time. We will make the parameters <span class="math inline">\(\delta\)</span> and <span class="math inline">\(r\)</span> vary. We set <span class="math inline">\(k\)</span> to <span class="math inline">\(5,000\)</span> and <span class="math inline">\(\tau\)</span> to 25.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>situations <span class="ot">&lt;-</span> </span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">expand_grid</span>(<span class="at">delta =</span> <span class="fu">c</span>(.<span class="dv">5</span>, <span class="fl">1.5</span>), <span class="at">r =</span> <span class="fu">c</span>(.<span class="dv">15</span>, .<span class="dv">25</span>, .<span class="dv">35</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">k =</span> <span class="dv">5000</span>, <span class="at">tau =</span> <span class="dv">25</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We create a function to get the values of <span class="math inline">\(C(t)\)</span> and its derivatives depending on the scenario.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="co">#' Simulation of Richards model for some parameters</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a><span class="co">#' </span></span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a><span class="co">#' @param i row number of situations</span></span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>simu_richards <span class="ot">&lt;-</span> <span class="cf">function</span>(i) {</span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>  current_params <span class="ot">&lt;-</span> situations <span class="sc">|&gt;</span> <span class="fu">slice</span>(i)</span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a>  current_params <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">as_vector</span>(current_params)) <span class="sc">|&gt;</span> <span class="fu">as.list</span>()</span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="dv">60</span></span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a>  step <span class="ot">&lt;-</span> .<span class="dv">01</span></span>
<span id="cb31-10"><a href="#cb31-10" aria-hidden="true" tabindex="-1"></a>  sim <span class="ot">&lt;-</span>  <span class="fu">richards_f</span>(<span class="at">theta =</span> current_params, <span class="at">x =</span> <span class="fu">seq</span>(<span class="dv">1</span>,n, <span class="at">by =</span> step))</span>
<span id="cb31-11"><a href="#cb31-11" aria-hidden="true" tabindex="-1"></a>  simD <span class="ot">&lt;-</span>  <span class="fu">richards_f_first_d</span>(<span class="at">theta =</span> current_params, <span class="at">x =</span> <span class="fu">seq</span>(<span class="dv">1</span>,n, <span class="at">by =</span> step))</span>
<span id="cb31-12"><a href="#cb31-12" aria-hidden="true" tabindex="-1"></a>  simD2 <span class="ot">&lt;-</span>  <span class="fu">richards_f_second_d</span>(<span class="at">theta =</span> current_params, <span class="at">x =</span> <span class="fu">seq</span>(<span class="dv">1</span>,n, <span class="at">by =</span> step))</span>
<span id="cb31-13"><a href="#cb31-13" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb31-14"><a href="#cb31-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(</span>
<span id="cb31-15"><a href="#cb31-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">t =</span> <span class="fu">seq</span>(<span class="dv">1</span>, n, <span class="at">by =</span> step),</span>
<span id="cb31-16"><a href="#cb31-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">k =</span> current_params[[<span class="st">"k"</span>]], </span>
<span id="cb31-17"><a href="#cb31-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">tau =</span> current_params[[<span class="st">"tau"</span>]],</span>
<span id="cb31-18"><a href="#cb31-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">r =</span> current_params[[<span class="st">"r"</span>]],</span>
<span id="cb31-19"><a href="#cb31-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">delta =</span> current_params[[<span class="st">"delta"</span>]],</span>
<span id="cb31-20"><a href="#cb31-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">sim =</span> sim</span>
<span id="cb31-21"><a href="#cb31-21" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">|&gt;</span> </span>
<span id="cb31-22"><a href="#cb31-22" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">simD =</span> simD,</span>
<span id="cb31-23"><a href="#cb31-23" aria-hidden="true" tabindex="-1"></a>           <span class="at">simD2 =</span> simD2)</span>
<span id="cb31-24"><a href="#cb31-24" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>This function is then applied to the different scenarios:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>simu_richards_res <span class="ot">&lt;-</span> <span class="fu">map_df</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(situations), simu_richards)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The thresholds:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>threshold_times <span class="ot">&lt;-</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>  simu_richards_res <span class="sc">|&gt;</span></span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(k, tau, r, delta) <span class="sc">|&gt;</span></span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">threshold_time =</span> <span class="fu">unique</span>(tau)) <span class="sc">|&gt;</span></span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">|&gt;</span></span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">r =</span> <span class="fu">str_c</span>(<span class="st">"$r = "</span>, r, <span class="st">"$"</span>),</span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">delta =</span> <span class="fu">str_c</span>(<span class="st">"$</span><span class="sc">\\</span><span class="st">delta = "</span>, delta, <span class="st">"$"</span>)</span>
<span id="cb33-9"><a href="#cb33-9" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'k', 'tau', 'r'. You can override using the
`.groups` argument.</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>p_simu_richards <span class="ot">&lt;-</span> </span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(</span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> simu_richards_res <span class="sc">|&gt;</span> </span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>      <span class="fu">mutate</span>(</span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>        <span class="at">r =</span> <span class="fu">str_c</span>(<span class="st">"$r = "</span>, r, <span class="st">"$"</span>),</span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a>        <span class="at">delta =</span> <span class="fu">str_c</span>(<span class="st">"$</span><span class="sc">\\</span><span class="st">delta = "</span>, delta, <span class="st">"$"</span>)</span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a>      ),</span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> t)</span>
<span id="cb35-9"><a href="#cb35-9" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb35-10"><a href="#cb35-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">y =</span> sim, <span class="at">linetype =</span> <span class="st">"sim"</span>)) <span class="sc">+</span></span>
<span id="cb35-11"><a href="#cb35-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">y =</span> simD <span class="sc">*</span> <span class="dv">10</span>, <span class="at">linetype =</span> <span class="st">"simD"</span>)) <span class="sc">+</span></span>
<span id="cb35-12"><a href="#cb35-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">y =</span> simD2 <span class="sc">*</span> <span class="dv">10</span>, <span class="at">linetype =</span> <span class="st">"simD2"</span>)) <span class="sc">+</span></span>
<span id="cb35-13"><a href="#cb35-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(</span>
<span id="cb35-14"><a href="#cb35-14" aria-hidden="true" tabindex="-1"></a>    r <span class="sc">~</span> delta,</span>
<span id="cb35-15"><a href="#cb35-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">labeller =</span> <span class="fu">as_labeller</span>(</span>
<span id="cb35-16"><a href="#cb35-16" aria-hidden="true" tabindex="-1"></a>      latex2exp<span class="sc">::</span>TeX, </span>
<span id="cb35-17"><a href="#cb35-17" aria-hidden="true" tabindex="-1"></a>      <span class="at">default =</span> label_parsed</span>
<span id="cb35-18"><a href="#cb35-18" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb35-19"><a href="#cb35-19" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb35-20"><a href="#cb35-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(</span>
<span id="cb35-21"><a href="#cb35-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> threshold_times, </span>
<span id="cb35-22"><a href="#cb35-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">xintercept =</span> threshold_time),</span>
<span id="cb35-23"><a href="#cb35-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">colour =</span> <span class="st">"red"</span>, <span class="at">linetype =</span> <span class="st">"dotted"</span>) <span class="sc">+</span></span>
<span id="cb35-24"><a href="#cb35-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Time"</span>, <span class="at">y =</span> latex2exp<span class="sc">::</span><span class="fu">TeX</span>(<span class="st">"$F(t)$"</span>)) <span class="sc">+</span></span>
<span id="cb35-25"><a href="#cb35-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(</span>
<span id="cb35-26"><a href="#cb35-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">labels =</span> comma,</span>
<span id="cb35-27"><a href="#cb35-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">5000</span>, <span class="at">by =</span> <span class="dv">1000</span>),</span>
<span id="cb35-28"><a href="#cb35-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">sec.axis =</span> <span class="fu">sec_axis</span>(</span>
<span id="cb35-29"><a href="#cb35-29" aria-hidden="true" tabindex="-1"></a>      <span class="sc">~</span>.<span class="sc">/</span><span class="dv">10</span>,</span>
<span id="cb35-30"><a href="#cb35-30" aria-hidden="true" tabindex="-1"></a>      <span class="at">name =</span> latex2exp<span class="sc">::</span><span class="fu">TeX</span>(</span>
<span id="cb35-31"><a href="#cb35-31" aria-hidden="true" tabindex="-1"></a>        <span class="st">"$</span><span class="sc">\\</span><span class="st">partial F(t)/</span><span class="sc">\\</span><span class="st">partial t$, $</span><span class="sc">\\</span><span class="st">partial^2 F(t)/</span><span class="sc">\\</span><span class="st">partial t^2$"</span></span>
<span id="cb35-32"><a href="#cb35-32" aria-hidden="true" tabindex="-1"></a>      ),</span>
<span id="cb35-33"><a href="#cb35-33" aria-hidden="true" tabindex="-1"></a>      <span class="at">labels =</span> comma)</span>
<span id="cb35-34"><a href="#cb35-34" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb35-35"><a href="#cb35-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_linetype_manual</span>(</span>
<span id="cb35-36"><a href="#cb35-36" aria-hidden="true" tabindex="-1"></a>    <span class="cn">NULL</span>,</span>
<span id="cb35-37"><a href="#cb35-37" aria-hidden="true" tabindex="-1"></a>    <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"sim"</span> <span class="ot">=</span> <span class="st">"solid"</span>, <span class="st">"simD"</span> <span class="ot">=</span> <span class="st">"dashed"</span>, <span class="st">"simD2"</span> <span class="ot">=</span> <span class="st">"dotdash"</span>),</span>
<span id="cb35-38"><a href="#cb35-38" aria-hidden="true" tabindex="-1"></a>    <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"sim"</span> <span class="ot">=</span> latex2exp<span class="sc">::</span><span class="fu">TeX</span>(<span class="st">"$F(t)$"</span>),</span>
<span id="cb35-39"><a href="#cb35-39" aria-hidden="true" tabindex="-1"></a>               <span class="st">"simD"</span> <span class="ot">=</span> latex2exp<span class="sc">::</span><span class="fu">TeX</span>(<span class="st">"$</span><span class="sc">\\</span><span class="st">partial F(t) / </span><span class="sc">\\</span><span class="st">partial t$"</span>),</span>
<span id="cb35-40"><a href="#cb35-40" aria-hidden="true" tabindex="-1"></a>               <span class="st">"simD2"</span> <span class="ot">=</span> latex2exp<span class="sc">::</span><span class="fu">TeX</span>(<span class="st">"$</span><span class="sc">\\</span><span class="st">partial^2 F(t) / </span><span class="sc">\\</span><span class="st">partial t^2$"</span>))</span>
<span id="cb35-41"><a href="#cb35-41" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb35-42"><a href="#cb35-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.ticks.y =</span> <span class="fu">element_blank</span>())</span>
<span id="cb35-43"><a href="#cb35-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-44"><a href="#cb35-44" aria-hidden="true" tabindex="-1"></a>p_simu_richards <span class="sc">+</span></span>
<span id="cb35-45"><a href="#cb35-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb35-46"><a href="#cb35-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-illustration-richards-model" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="phenomeological-background_files/figure-html/fig-illustration-richards-model-1.png" class="img-fluid figure-img" width="672"></p>
<p></p><figcaption class="figure-caption">Figure&nbsp;6.4: Illustration of Richards’ model for different values for <span class="math inline">\(\delta\)</span> and <span class="math inline">\(r\)</span>, with <span class="math inline">\(k=5,000\)</span> and <span class="math inline">\(\tau=25\)</span></figcaption><p></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="double-sigmoid-functions-to-account-for-a-second-wave" class="level2" data-number="6.2">
<h2 data-number="6.2" class="anchored" data-anchor-id="double-sigmoid-functions-to-account-for-a-second-wave"><span class="header-section-number">6.2</span> Double sigmoid functions to account for a second wave</h2>
<p>One possibility to account for two distinct phases is to use a double sigmoid. This is done by adding or multiplying two sigmoid functions, as follows: <span class="math display">\[
C(t) = C_{1}^{(m_1)}(t) + C_{2}^{(m_2)}(t),
\]</span> where <span class="math inline">\(C_{1}^{(m_1)}(t)\)</span> is the first sigmoid function and <span class="math inline">\(C_{2}^{(m_2)}(t)\)</span> is the second one. The types <span class="math inline">\(m_1\)</span> and <span class="math inline">\(m_2\)</span> of sigmoid can be, for example, a logistic curve (see, <em>e.g.</em>, <span class="citation" data-cites="Lipovetsky_2010_JoAS">Lipovetsky (<a href="references.html#ref-Lipovetsky_2010_JoAS" role="doc-biblioref">2010</a>)</span> or <span class="citation" data-cites="bock_1973_HB">Bock et al. (<a href="references.html#ref-bock_1973_HB" role="doc-biblioref">1973</a>)</span>), a Gompertz curve <span class="citation" data-cites="Thissen_1976_AHB">Thissen et al. (<a href="references.html#ref-Thissen_1976_AHB" role="doc-biblioref">1976</a>)</span>, or a Richards curve <span class="citation" data-cites="Oswald_2012_FlexParamCurve">Oswald et al. (<a href="references.html#ref-Oswald_2012_FlexParamCurve" role="doc-biblioref">2012</a>)</span>.</p>
<p>We limit ourselves here to the presentation of a double-Gompertz curve: <span class="math display">\[
\begin{aligned}
C(t)  = &amp; K_1\exp\left[ -\exp\left( -r_1(t-\tau_1)\right)\right] \\
&amp; + (K_2 - K_1)\exp\left[ -\exp\left( -r_2(t-\tau_2)\right)\right],
\end{aligned}
\]</span> where <span class="math inline">\(K_1\)</span> and <span class="math inline">\(K_2\)</span> are the intermediate and final plateau of saturation, respectively. The parameters <span class="math inline">\(\tau_1\)</span> and <span class="math inline">\(\tau_2\)</span> define the inflection points of each phase when the intermediate plateau is long enough while the growth of the process is determined by <span class="math inline">\(r_1\)</span> and <span class="math inline">\(r_2\)</span>, for the first and second sigmoid. However there is no analytical formula to determine the value and position of the two peaks. We have to evaluate numerically the extremum of the second order derivative of <span class="math inline">\(C(t)\)</span>. The first order derivative of <span class="math inline">\(C(t)\)</span> provides an estimate of the number of cases at each point of time: <span class="math display">\[
\begin{aligned}
\frac{\partial C(t)}{\partial t}  =  &amp; K_1 r_1 \exp(-r_1(t-\tau_1) \exp(-\exp(-r1(t-\tau1))) \\
&amp; + (K_2-K_1)r_2\exp(-r_2(t-\tau_2) \exp(-\exp(-r2(t-\tau2))).
\end{aligned}
\]</span> The formula giving the relative speed <span class="math inline">\(c(t)/C(t)\)</span> does not lead to any simplification and will not be detailed.</p>
<section id="double-logistic" class="level3" data-number="6.2.1">
<h3 data-number="6.2.1" class="anchored" data-anchor-id="double-logistic"><span class="header-section-number">6.2.1</span> Double Logistic</h3>
<p>The double logistic function, its first and second derivatives with respect to time can be coded as follows:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Double logistic</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>double_logistic_f <span class="ot">&lt;-</span>  <span class="cf">function</span>(theta, x) {</span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>  K1 <span class="ot">&lt;-</span> theta[[<span class="st">"K1"</span>]]</span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>  tau1 <span class="ot">&lt;-</span> theta[[<span class="st">"tau1"</span>]]</span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a>  r1 <span class="ot">&lt;-</span> theta[[<span class="st">"r1"</span>]]</span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a>  K2 <span class="ot">&lt;-</span> theta[[<span class="st">"K2"</span>]]</span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a>  tau2 <span class="ot">&lt;-</span> theta[[<span class="st">"tau2"</span>]]</span>
<span id="cb36-8"><a href="#cb36-8" aria-hidden="true" tabindex="-1"></a>  r2 <span class="ot">&lt;-</span> theta[[<span class="st">"r2"</span>]]</span>
<span id="cb36-9"><a href="#cb36-9" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb36-10"><a href="#cb36-10" aria-hidden="true" tabindex="-1"></a>  (K1<span class="sc">/</span>(<span class="dv">1</span> <span class="sc">+</span> <span class="fu">exp</span>(<span class="sc">-</span>r1 <span class="sc">*</span> (x <span class="sc">-</span> tau1)))) <span class="sc">+</span> ((K2 <span class="sc">-</span> K1)<span class="sc">/</span>(<span class="dv">1</span> <span class="sc">+</span> <span class="fu">exp</span>(<span class="sc">-</span>r2 <span class="sc">*</span> (x <span class="sc">-</span> tau2))))</span>
<span id="cb36-11"><a href="#cb36-11" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb36-12"><a href="#cb36-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Double logistic in two parts</span></span>
<span id="cb36-13"><a href="#cb36-13" aria-hidden="true" tabindex="-1"></a>double_logistic_f_2 <span class="ot">&lt;-</span> <span class="cf">function</span>(theta, x) {</span>
<span id="cb36-14"><a href="#cb36-14" aria-hidden="true" tabindex="-1"></a>  K1 <span class="ot">&lt;-</span> theta[[<span class="st">"K1"</span>]]</span>
<span id="cb36-15"><a href="#cb36-15" aria-hidden="true" tabindex="-1"></a>  tau1 <span class="ot">&lt;-</span> theta[[<span class="st">"tau1"</span>]]</span>
<span id="cb36-16"><a href="#cb36-16" aria-hidden="true" tabindex="-1"></a>  r1 <span class="ot">&lt;-</span> theta[[<span class="st">"r1"</span>]]</span>
<span id="cb36-17"><a href="#cb36-17" aria-hidden="true" tabindex="-1"></a>  K2 <span class="ot">&lt;-</span> theta[[<span class="st">"K2"</span>]]</span>
<span id="cb36-18"><a href="#cb36-18" aria-hidden="true" tabindex="-1"></a>  tau2 <span class="ot">&lt;-</span> theta[[<span class="st">"tau2"</span>]]</span>
<span id="cb36-19"><a href="#cb36-19" aria-hidden="true" tabindex="-1"></a>  r2 <span class="ot">&lt;-</span> theta[[<span class="st">"r2"</span>]]</span>
<span id="cb36-20"><a href="#cb36-20" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb36-21"><a href="#cb36-21" aria-hidden="true" tabindex="-1"></a>  f_1 <span class="ot">&lt;-</span> K1 <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">+</span> <span class="fu">exp</span>(<span class="sc">-</span>r1 <span class="sc">*</span> (x <span class="sc">-</span> tau1)))</span>
<span id="cb36-22"><a href="#cb36-22" aria-hidden="true" tabindex="-1"></a>  f_2 <span class="ot">&lt;-</span> (K2 <span class="sc">-</span> K1)<span class="sc">/</span>(<span class="dv">1</span> <span class="sc">+</span> <span class="fu">exp</span>(<span class="sc">-</span>r2 <span class="sc">*</span> (x <span class="sc">-</span> tau2)))</span>
<span id="cb36-23"><a href="#cb36-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(<span class="at">x =</span> x, <span class="at">f_1 =</span> f_1, <span class="at">f_2 =</span> f_2)</span>
<span id="cb36-24"><a href="#cb36-24" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb36-25"><a href="#cb36-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-26"><a href="#cb36-26" aria-hidden="true" tabindex="-1"></a><span class="co"># First derivative</span></span>
<span id="cb36-27"><a href="#cb36-27" aria-hidden="true" tabindex="-1"></a>double_logistic_f_first_d <span class="ot">&lt;-</span>  <span class="cf">function</span>(theta, x) {</span>
<span id="cb36-28"><a href="#cb36-28" aria-hidden="true" tabindex="-1"></a>  K1 <span class="ot">&lt;-</span> theta[[<span class="st">"K1"</span>]]</span>
<span id="cb36-29"><a href="#cb36-29" aria-hidden="true" tabindex="-1"></a>  tau1 <span class="ot">&lt;-</span> theta[[<span class="st">"tau1"</span>]]</span>
<span id="cb36-30"><a href="#cb36-30" aria-hidden="true" tabindex="-1"></a>  r1 <span class="ot">&lt;-</span> theta[[<span class="st">"r1"</span>]]</span>
<span id="cb36-31"><a href="#cb36-31" aria-hidden="true" tabindex="-1"></a>  K2 <span class="ot">&lt;-</span> theta[[<span class="st">"K2"</span>]]</span>
<span id="cb36-32"><a href="#cb36-32" aria-hidden="true" tabindex="-1"></a>  tau2 <span class="ot">&lt;-</span> theta[[<span class="st">"tau2"</span>]]</span>
<span id="cb36-33"><a href="#cb36-33" aria-hidden="true" tabindex="-1"></a>  r2 <span class="ot">&lt;-</span> theta[[<span class="st">"r2"</span>]]</span>
<span id="cb36-34"><a href="#cb36-34" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb36-35"><a href="#cb36-35" aria-hidden="true" tabindex="-1"></a>  (r1 <span class="sc">*</span> K1 <span class="sc">*</span> <span class="fu">exp</span>(<span class="sc">-</span>r1 <span class="sc">*</span> (x <span class="sc">-</span> tau1))) <span class="sc">/</span> ((<span class="fu">exp</span>(<span class="sc">-</span>r1 <span class="sc">*</span> (x<span class="sc">-</span>tau1)) <span class="sc">+</span> <span class="dv">1</span>)<span class="sc">^</span><span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb36-36"><a href="#cb36-36" aria-hidden="true" tabindex="-1"></a>    (r2 <span class="sc">*</span> (K2<span class="sc">-</span>K1) <span class="sc">*</span> <span class="fu">exp</span>(<span class="sc">-</span>r2 <span class="sc">*</span> (x <span class="sc">-</span> tau2))) <span class="sc">/</span> ((<span class="fu">exp</span>(<span class="sc">-</span>r2 <span class="sc">*</span> (x<span class="sc">-</span>tau2)) <span class="sc">+</span> <span class="dv">1</span>)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb36-37"><a href="#cb36-37" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb36-38"><a href="#cb36-38" aria-hidden="true" tabindex="-1"></a><span class="co"># Second derivative</span></span>
<span id="cb36-39"><a href="#cb36-39" aria-hidden="true" tabindex="-1"></a>double_logistic_f_second_d <span class="ot">&lt;-</span>  <span class="cf">function</span>(theta, x) {</span>
<span id="cb36-40"><a href="#cb36-40" aria-hidden="true" tabindex="-1"></a>  K1 <span class="ot">&lt;-</span> theta[[<span class="st">"K1"</span>]]</span>
<span id="cb36-41"><a href="#cb36-41" aria-hidden="true" tabindex="-1"></a>  tau1 <span class="ot">&lt;-</span> theta[[<span class="st">"tau1"</span>]]</span>
<span id="cb36-42"><a href="#cb36-42" aria-hidden="true" tabindex="-1"></a>  r1 <span class="ot">&lt;-</span> theta[[<span class="st">"r1"</span>]]</span>
<span id="cb36-43"><a href="#cb36-43" aria-hidden="true" tabindex="-1"></a>  K2 <span class="ot">&lt;-</span> theta[[<span class="st">"K2"</span>]]</span>
<span id="cb36-44"><a href="#cb36-44" aria-hidden="true" tabindex="-1"></a>  tau2 <span class="ot">&lt;-</span> theta[[<span class="st">"tau2"</span>]]</span>
<span id="cb36-45"><a href="#cb36-45" aria-hidden="true" tabindex="-1"></a>  r2 <span class="ot">&lt;-</span> theta[[<span class="st">"r2"</span>]]</span>
<span id="cb36-46"><a href="#cb36-46" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb36-47"><a href="#cb36-47" aria-hidden="true" tabindex="-1"></a>  K1 <span class="sc">*</span>  ((<span class="dv">2</span> <span class="sc">*</span> r1<span class="sc">^</span><span class="dv">2</span> <span class="sc">*</span> <span class="fu">exp</span>(<span class="sc">-</span><span class="dv">2</span> <span class="sc">*</span> r1 <span class="sc">*</span> (x <span class="sc">-</span> tau1)))<span class="sc">/</span>(<span class="fu">exp</span>(<span class="sc">-</span>r1 <span class="sc">*</span> (x <span class="sc">-</span> tau1)) <span class="sc">+</span> <span class="dv">1</span>)<span class="sc">^</span><span class="dv">3</span> <span class="sc">-</span> </span>
<span id="cb36-48"><a href="#cb36-48" aria-hidden="true" tabindex="-1"></a>           ( r1<span class="sc">^</span><span class="dv">2</span> <span class="sc">*</span> <span class="fu">exp</span>(<span class="sc">-</span> r1 <span class="sc">*</span> (x <span class="sc">-</span> tau1)))<span class="sc">/</span>(<span class="fu">exp</span>(<span class="sc">-</span>r1 <span class="sc">*</span> (x <span class="sc">-</span> tau1)) <span class="sc">+</span> <span class="dv">1</span>)<span class="sc">^</span><span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb36-49"><a href="#cb36-49" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb36-50"><a href="#cb36-50" aria-hidden="true" tabindex="-1"></a>    (K2<span class="sc">-</span>K1) <span class="sc">*</span>  </span>
<span id="cb36-51"><a href="#cb36-51" aria-hidden="true" tabindex="-1"></a>    ((<span class="dv">2</span> <span class="sc">*</span> r2<span class="sc">^</span><span class="dv">2</span> <span class="sc">*</span> <span class="fu">exp</span>(<span class="sc">-</span><span class="dv">2</span> <span class="sc">*</span> r2 <span class="sc">*</span> (x <span class="sc">-</span> tau2)))<span class="sc">/</span>(<span class="fu">exp</span>(<span class="sc">-</span>r2 <span class="sc">*</span> (x <span class="sc">-</span> tau2)) <span class="sc">+</span> <span class="dv">1</span>)<span class="sc">^</span><span class="dv">3</span> <span class="sc">-</span> </span>
<span id="cb36-52"><a href="#cb36-52" aria-hidden="true" tabindex="-1"></a>       ( r2<span class="sc">^</span><span class="dv">2</span> <span class="sc">*</span> <span class="fu">exp</span>(<span class="sc">-</span> r2 <span class="sc">*</span> (x <span class="sc">-</span> tau2)))<span class="sc">/</span>(<span class="fu">exp</span>(<span class="sc">-</span>r2 <span class="sc">*</span> (x <span class="sc">-</span> tau2)) <span class="sc">+</span> <span class="dv">1</span>)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb36-53"><a href="#cb36-53" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb36-54"><a href="#cb36-54" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>And now, let us make some illustrations by varying <span class="math inline">\(r_1\)</span> and <span class="math inline">\(r_2\)</span>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>situations <span class="ot">&lt;-</span> </span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">expand_grid</span>(<span class="at">r1 =</span> <span class="fu">c</span>(.<span class="dv">2</span>, .<span class="dv">5</span>), <span class="at">r2 =</span> <span class="fu">c</span>(.<span class="dv">2</span>, .<span class="dv">5</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">K1   =</span> <span class="dv">2500</span>,</span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">K2   =</span> <span class="dv">5000</span>,</span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">tau1 =</span> <span class="dv">20</span>,</span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">tau2 =</span> <span class="dv">40</span></span>
<span id="cb37-8"><a href="#cb37-8" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The function that simulates <span class="math inline">\(C(t)\)</span> and its first and second derivatives with respect to time for a single scenario:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="co">#' Simulation of the logistic model for some parameters</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a><span class="co">#' </span></span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a><span class="co">#' @param i row number of situations</span></span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>simu <span class="ot">&lt;-</span> <span class="cf">function</span>(i) {</span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a>  current_params <span class="ot">&lt;-</span> situations <span class="sc">|&gt;</span> <span class="fu">slice</span>(i)</span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a>  current_params <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">as_vector</span>(current_params)) <span class="sc">|&gt;</span> <span class="fu">as.list</span>()</span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb38-8"><a href="#cb38-8" aria-hidden="true" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="dv">60</span></span>
<span id="cb38-9"><a href="#cb38-9" aria-hidden="true" tabindex="-1"></a>  step <span class="ot">&lt;-</span> .<span class="dv">01</span></span>
<span id="cb38-10"><a href="#cb38-10" aria-hidden="true" tabindex="-1"></a>  sim <span class="ot">&lt;-</span>  <span class="fu">double_logistic_f</span>(<span class="at">theta =</span> current_params, <span class="at">x =</span> <span class="fu">seq</span>(<span class="dv">1</span>,n, <span class="at">by =</span> step))</span>
<span id="cb38-11"><a href="#cb38-11" aria-hidden="true" tabindex="-1"></a>  simD <span class="ot">&lt;-</span>  <span class="fu">double_logistic_f_first_d</span>(</span>
<span id="cb38-12"><a href="#cb38-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">theta =</span> current_params, <span class="at">x =</span> <span class="fu">seq</span>(<span class="dv">1</span>,n, <span class="at">by =</span> step))</span>
<span id="cb38-13"><a href="#cb38-13" aria-hidden="true" tabindex="-1"></a>  simD2 <span class="ot">&lt;-</span>  <span class="fu">double_logistic_f_second_d</span>(</span>
<span id="cb38-14"><a href="#cb38-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">theta =</span> current_params, <span class="at">x =</span> <span class="fu">seq</span>(<span class="dv">1</span>,n, <span class="at">by =</span> step))</span>
<span id="cb38-15"><a href="#cb38-15" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb38-16"><a href="#cb38-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(</span>
<span id="cb38-17"><a href="#cb38-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">t =</span> <span class="fu">seq</span>(<span class="dv">1</span>, n, <span class="at">by =</span> step),</span>
<span id="cb38-18"><a href="#cb38-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">K1 =</span> current_params[[<span class="st">"K1"</span>]],</span>
<span id="cb38-19"><a href="#cb38-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">r1 =</span> current_params[[<span class="st">"r1"</span>]],</span>
<span id="cb38-20"><a href="#cb38-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">tau1 =</span> current_params[[<span class="st">"tau1"</span>]],</span>
<span id="cb38-21"><a href="#cb38-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">K2 =</span> current_params[[<span class="st">"K2"</span>]],</span>
<span id="cb38-22"><a href="#cb38-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">r2 =</span> current_params[[<span class="st">"r2"</span>]],</span>
<span id="cb38-23"><a href="#cb38-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">tau2 =</span> current_params[[<span class="st">"tau2"</span>]],</span>
<span id="cb38-24"><a href="#cb38-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">sim =</span> sim) <span class="sc">|&gt;</span> </span>
<span id="cb38-25"><a href="#cb38-25" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">simD =</span> simD,</span>
<span id="cb38-26"><a href="#cb38-26" aria-hidden="true" tabindex="-1"></a>           <span class="at">simD2 =</span> simD2)</span>
<span id="cb38-27"><a href="#cb38-27" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb38-28"><a href="#cb38-28" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The simulated values for all the scenarios:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>simu_res <span class="ot">&lt;-</span> <span class="fu">map_df</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(situations), simu)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The thresholds:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>threshold_times <span class="ot">&lt;-</span> </span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>  simu_res <span class="sc">|&gt;</span> </span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(K1, tau1, r1, K2, tau2, r2) <span class="sc">|&gt;</span> </span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">threshold_time_1 =</span> <span class="fu">unique</span>(tau1),</span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">threshold_time_2 =</span> <span class="fu">unique</span>(tau2)</span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span> </span>
<span id="cb40-8"><a href="#cb40-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">|&gt;</span> </span>
<span id="cb40-9"><a href="#cb40-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb40-10"><a href="#cb40-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">r1 =</span> <span class="fu">str_c</span>(<span class="st">"$r_1 = "</span>, r1, <span class="st">"$"</span>),</span>
<span id="cb40-11"><a href="#cb40-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">r2 =</span> <span class="fu">str_c</span>(<span class="st">"$r_2 = "</span>, r2, <span class="st">"$"</span>)</span>
<span id="cb40-12"><a href="#cb40-12" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'K1', 'tau1', 'r1', 'K2', 'tau2'. You can
override using the `.groups` argument.</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>p_simu_double_logis <span class="ot">&lt;-</span> </span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(</span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> simu_res <span class="sc">|&gt;</span> </span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a>      <span class="fu">mutate</span>(</span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a>        <span class="at">r1 =</span> <span class="fu">str_c</span>(<span class="st">"$r_1 = "</span>, r1, <span class="st">"$"</span>),</span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a>        <span class="at">r2 =</span> <span class="fu">str_c</span>(<span class="st">"$r_2 = "</span>, r2, <span class="st">"$"</span>)</span>
<span id="cb42-7"><a href="#cb42-7" aria-hidden="true" tabindex="-1"></a>      ),</span>
<span id="cb42-8"><a href="#cb42-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> t)</span>
<span id="cb42-9"><a href="#cb42-9" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb42-10"><a href="#cb42-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> sim, <span class="at">linetype =</span> <span class="st">"sim"</span>)) <span class="sc">+</span></span>
<span id="cb42-11"><a href="#cb42-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> simD <span class="sc">*</span> <span class="dv">10</span>, <span class="at">linetype =</span> <span class="st">"simD"</span>)) <span class="sc">+</span></span>
<span id="cb42-12"><a href="#cb42-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> simD2 <span class="sc">*</span> <span class="dv">10</span>, <span class="at">linetype =</span> <span class="st">"simD2"</span>)) <span class="sc">+</span></span>
<span id="cb42-13"><a href="#cb42-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(</span>
<span id="cb42-14"><a href="#cb42-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> threshold_times,</span>
<span id="cb42-15"><a href="#cb42-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">xintercept =</span> threshold_time_1),</span>
<span id="cb42-16"><a href="#cb42-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">colour =</span> <span class="st">"red"</span>, <span class="at">linetype =</span> <span class="st">"dotted"</span>) <span class="sc">+</span></span>
<span id="cb42-17"><a href="#cb42-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(</span>
<span id="cb42-18"><a href="#cb42-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> threshold_times,</span>
<span id="cb42-19"><a href="#cb42-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">xintercept =</span> threshold_time_2),</span>
<span id="cb42-20"><a href="#cb42-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">colour =</span> <span class="st">"red"</span>, <span class="at">linetype =</span> <span class="st">"dotted"</span>) <span class="sc">+</span></span>
<span id="cb42-21"><a href="#cb42-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(</span>
<span id="cb42-22"><a href="#cb42-22" aria-hidden="true" tabindex="-1"></a>    r2 <span class="sc">~</span> r1,</span>
<span id="cb42-23"><a href="#cb42-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">labeller =</span> <span class="fu">as_labeller</span>(</span>
<span id="cb42-24"><a href="#cb42-24" aria-hidden="true" tabindex="-1"></a>      latex2exp<span class="sc">::</span>TeX, </span>
<span id="cb42-25"><a href="#cb42-25" aria-hidden="true" tabindex="-1"></a>      <span class="at">default =</span> label_parsed</span>
<span id="cb42-26"><a href="#cb42-26" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb42-27"><a href="#cb42-27" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb42-28"><a href="#cb42-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Time"</span>, <span class="at">y =</span> <span class="st">"$F(t)$"</span>) <span class="sc">+</span></span>
<span id="cb42-29"><a href="#cb42-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(</span>
<span id="cb42-30"><a href="#cb42-30" aria-hidden="true" tabindex="-1"></a>    <span class="at">labels =</span> comma,</span>
<span id="cb42-31"><a href="#cb42-31" aria-hidden="true" tabindex="-1"></a>    <span class="at">sec.axis =</span> <span class="fu">sec_axis</span>(</span>
<span id="cb42-32"><a href="#cb42-32" aria-hidden="true" tabindex="-1"></a>      <span class="sc">~</span>.<span class="sc">/</span><span class="dv">10</span>,</span>
<span id="cb42-33"><a href="#cb42-33" aria-hidden="true" tabindex="-1"></a>      <span class="at">name =</span> latex2exp<span class="sc">::</span><span class="fu">TeX</span>(</span>
<span id="cb42-34"><a href="#cb42-34" aria-hidden="true" tabindex="-1"></a>        <span class="st">"$</span><span class="sc">\\</span><span class="st">partial F(t) / </span><span class="sc">\\</span><span class="st">partial t$, $</span><span class="sc">\\</span><span class="st">partial^2 F(t) / </span><span class="sc">\\</span><span class="st">partial t^2$"</span></span>
<span id="cb42-35"><a href="#cb42-35" aria-hidden="true" tabindex="-1"></a>      ),</span>
<span id="cb42-36"><a href="#cb42-36" aria-hidden="true" tabindex="-1"></a>      <span class="at">labels =</span> comma)</span>
<span id="cb42-37"><a href="#cb42-37" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb42-38"><a href="#cb42-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_linetype_manual</span>(</span>
<span id="cb42-39"><a href="#cb42-39" aria-hidden="true" tabindex="-1"></a>    <span class="cn">NULL</span>,</span>
<span id="cb42-40"><a href="#cb42-40" aria-hidden="true" tabindex="-1"></a>    <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"sim"</span> <span class="ot">=</span> <span class="st">"solid"</span>, <span class="st">"simD"</span> <span class="ot">=</span> <span class="st">"dashed"</span>, <span class="st">"simD2"</span> <span class="ot">=</span> <span class="st">"dotdash"</span>),</span>
<span id="cb42-41"><a href="#cb42-41" aria-hidden="true" tabindex="-1"></a>    <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"sim"</span> <span class="ot">=</span> latex2exp<span class="sc">::</span><span class="fu">TeX</span>(<span class="st">"$F(t)$"</span>), </span>
<span id="cb42-42"><a href="#cb42-42" aria-hidden="true" tabindex="-1"></a>               <span class="st">"simD"</span> <span class="ot">=</span> latex2exp<span class="sc">::</span><span class="fu">TeX</span>(<span class="st">"$</span><span class="sc">\\</span><span class="st">partial F(t) / </span><span class="sc">\\</span><span class="st">partial t$"</span>),</span>
<span id="cb42-43"><a href="#cb42-43" aria-hidden="true" tabindex="-1"></a>               <span class="st">"simD2"</span> <span class="ot">=</span> latex2exp<span class="sc">::</span><span class="fu">TeX</span>(<span class="st">"$</span><span class="sc">\\</span><span class="st">partial^2 F(t) / </span><span class="sc">\\</span><span class="st">partial t^2$"</span>))</span>
<span id="cb42-44"><a href="#cb42-44" aria-hidden="true" tabindex="-1"></a>               ) <span class="sc">+</span></span>
<span id="cb42-45"><a href="#cb42-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.ticks.y =</span> <span class="fu">element_blank</span>())</span>
<span id="cb42-46"><a href="#cb42-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-47"><a href="#cb42-47" aria-hidden="true" tabindex="-1"></a>p_simu_double_logis <span class="sc">+</span></span>
<span id="cb42-48"><a href="#cb42-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb42-49"><a href="#cb42-49" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-illustration-double-logistic-model" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="phenomeological-background_files/figure-html/fig-illustration-double-logistic-model-1.png" class="img-fluid figure-img" width="672"></p>
<p></p><figcaption class="figure-caption">Figure&nbsp;6.5: Illustration of a Double Logistic model for different values for <span class="math inline">\(r_1\)</span> and <span class="math inline">\(r_2\)</span>, with <span class="math inline">\(K_1=2,500\)</span>, <span class="math inline">\(K_2 = 5,000\)</span>, <span class="math inline">\(\tau_1 = 20\)</span>, and <span class="math inline">\(\tau_2 = 40\)</span></figcaption><p></p>
</figure>
</div>
</div>
</div>
</section>
<section id="double-gompertz-model" class="level3" data-number="6.2.2">
<h3 data-number="6.2.2" class="anchored" data-anchor-id="double-gompertz-model"><span class="header-section-number">6.2.2</span> Double Gompertz Model</h3>
<p>The double Gompertz function, its first and second derivatives with respect to time can be coded as follows:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Double-Gompertz function</span></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a><span class="co">#' @param theta vector of named parameters</span></span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a><span class="co">#' @param x observation / training example</span></span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a>double_gompertz_f <span class="ot">&lt;-</span> <span class="cf">function</span>(theta, x) {</span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a>  K1 <span class="ot">&lt;-</span> theta[[<span class="st">"K1"</span>]]</span>
<span id="cb43-6"><a href="#cb43-6" aria-hidden="true" tabindex="-1"></a>  tau1 <span class="ot">&lt;-</span> theta[[<span class="st">"tau1"</span>]]</span>
<span id="cb43-7"><a href="#cb43-7" aria-hidden="true" tabindex="-1"></a>  r1 <span class="ot">&lt;-</span> theta[[<span class="st">"r1"</span>]]</span>
<span id="cb43-8"><a href="#cb43-8" aria-hidden="true" tabindex="-1"></a>  K2 <span class="ot">&lt;-</span> theta[[<span class="st">"K2"</span>]]</span>
<span id="cb43-9"><a href="#cb43-9" aria-hidden="true" tabindex="-1"></a>  tau2 <span class="ot">&lt;-</span> theta[[<span class="st">"tau2"</span>]]</span>
<span id="cb43-10"><a href="#cb43-10" aria-hidden="true" tabindex="-1"></a>  r2 <span class="ot">&lt;-</span> theta[[<span class="st">"r2"</span>]]</span>
<span id="cb43-11"><a href="#cb43-11" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb43-12"><a href="#cb43-12" aria-hidden="true" tabindex="-1"></a>  f_1 <span class="ot">&lt;-</span> K1 <span class="sc">*</span> <span class="fu">exp</span>(<span class="sc">-</span><span class="fu">exp</span>(<span class="sc">-</span>r1 <span class="sc">*</span> (x <span class="sc">-</span> tau1)))</span>
<span id="cb43-13"><a href="#cb43-13" aria-hidden="true" tabindex="-1"></a>  f_2 <span class="ot">&lt;-</span> (K2<span class="sc">-</span>K1) <span class="sc">*</span> <span class="fu">exp</span>(<span class="sc">-</span><span class="fu">exp</span>(<span class="sc">-</span>r2 <span class="sc">*</span> (x <span class="sc">-</span> tau2)))</span>
<span id="cb43-14"><a href="#cb43-14" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb43-15"><a href="#cb43-15" aria-hidden="true" tabindex="-1"></a>  f_1 <span class="sc">+</span> f_2</span>
<span id="cb43-16"><a href="#cb43-16" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb43-17"><a href="#cb43-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-18"><a href="#cb43-18" aria-hidden="true" tabindex="-1"></a><span class="co">#' Double-Gompertz function in two parts</span></span>
<span id="cb43-19"><a href="#cb43-19" aria-hidden="true" tabindex="-1"></a><span class="co">#' </span></span>
<span id="cb43-20"><a href="#cb43-20" aria-hidden="true" tabindex="-1"></a>double_gompertz_f_2 <span class="ot">&lt;-</span> <span class="cf">function</span>(theta, x) {</span>
<span id="cb43-21"><a href="#cb43-21" aria-hidden="true" tabindex="-1"></a>  K1 <span class="ot">&lt;-</span> theta[[<span class="st">"K1"</span>]]</span>
<span id="cb43-22"><a href="#cb43-22" aria-hidden="true" tabindex="-1"></a>  tau1 <span class="ot">&lt;-</span> theta[[<span class="st">"tau1"</span>]]</span>
<span id="cb43-23"><a href="#cb43-23" aria-hidden="true" tabindex="-1"></a>  r1 <span class="ot">&lt;-</span> theta[[<span class="st">"r1"</span>]]</span>
<span id="cb43-24"><a href="#cb43-24" aria-hidden="true" tabindex="-1"></a>  K2 <span class="ot">&lt;-</span> theta[[<span class="st">"K2"</span>]]</span>
<span id="cb43-25"><a href="#cb43-25" aria-hidden="true" tabindex="-1"></a>  tau2 <span class="ot">&lt;-</span> theta[[<span class="st">"tau2"</span>]]</span>
<span id="cb43-26"><a href="#cb43-26" aria-hidden="true" tabindex="-1"></a>  r2 <span class="ot">&lt;-</span> theta[[<span class="st">"r2"</span>]]</span>
<span id="cb43-27"><a href="#cb43-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-28"><a href="#cb43-28" aria-hidden="true" tabindex="-1"></a>  f_1 <span class="ot">&lt;-</span> K1 <span class="sc">*</span> <span class="fu">exp</span>(<span class="sc">-</span><span class="fu">exp</span>(<span class="sc">-</span>r1 <span class="sc">*</span> (x <span class="sc">-</span> tau1)))</span>
<span id="cb43-29"><a href="#cb43-29" aria-hidden="true" tabindex="-1"></a>  f_2 <span class="ot">&lt;-</span> (K2<span class="sc">-</span>K1) <span class="sc">*</span> <span class="fu">exp</span>(<span class="sc">-</span><span class="fu">exp</span>(<span class="sc">-</span>r2 <span class="sc">*</span> (x<span class="sc">-</span>tau2)))</span>
<span id="cb43-30"><a href="#cb43-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(<span class="at">x =</span> x, <span class="at">f_1 =</span> f_1, <span class="at">f_2 =</span> f_2)</span>
<span id="cb43-31"><a href="#cb43-31" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb43-32"><a href="#cb43-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-33"><a href="#cb43-33" aria-hidden="true" tabindex="-1"></a><span class="co">#' First derivative</span></span>
<span id="cb43-34"><a href="#cb43-34" aria-hidden="true" tabindex="-1"></a><span class="co">#' </span></span>
<span id="cb43-35"><a href="#cb43-35" aria-hidden="true" tabindex="-1"></a>double_gompertz_f_first_d <span class="ot">&lt;-</span> <span class="cf">function</span>(theta, x) {</span>
<span id="cb43-36"><a href="#cb43-36" aria-hidden="true" tabindex="-1"></a>  K1 <span class="ot">&lt;-</span> theta[[<span class="st">"K1"</span>]]</span>
<span id="cb43-37"><a href="#cb43-37" aria-hidden="true" tabindex="-1"></a>  tau1 <span class="ot">&lt;-</span> theta[[<span class="st">"tau1"</span>]]</span>
<span id="cb43-38"><a href="#cb43-38" aria-hidden="true" tabindex="-1"></a>  r1 <span class="ot">&lt;-</span> theta[[<span class="st">"r1"</span>]]</span>
<span id="cb43-39"><a href="#cb43-39" aria-hidden="true" tabindex="-1"></a>  K2 <span class="ot">&lt;-</span> theta[[<span class="st">"K2"</span>]]</span>
<span id="cb43-40"><a href="#cb43-40" aria-hidden="true" tabindex="-1"></a>  tau2 <span class="ot">&lt;-</span> theta[[<span class="st">"tau2"</span>]]</span>
<span id="cb43-41"><a href="#cb43-41" aria-hidden="true" tabindex="-1"></a>  r2 <span class="ot">&lt;-</span> theta[[<span class="st">"r2"</span>]]</span>
<span id="cb43-42"><a href="#cb43-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-43"><a href="#cb43-43" aria-hidden="true" tabindex="-1"></a>  f_1_d <span class="ot">&lt;-</span> r1 <span class="sc">*</span> K1 <span class="sc">*</span> <span class="fu">exp</span>(<span class="sc">-</span>r1 <span class="sc">*</span> (x <span class="sc">-</span> tau1) <span class="sc">-</span> <span class="fu">exp</span>(<span class="sc">-</span> r1 <span class="sc">*</span> (x <span class="sc">-</span> tau1)))</span>
<span id="cb43-44"><a href="#cb43-44" aria-hidden="true" tabindex="-1"></a>  f_2_d <span class="ot">&lt;-</span> r2 <span class="sc">*</span> (K2<span class="sc">-</span>K1) <span class="sc">*</span> <span class="fu">exp</span>(<span class="sc">-</span>r2 <span class="sc">*</span> (x <span class="sc">-</span> tau2) <span class="sc">-</span> <span class="fu">exp</span>(<span class="sc">-</span> r2 <span class="sc">*</span> (x <span class="sc">-</span> tau2)))</span>
<span id="cb43-45"><a href="#cb43-45" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb43-46"><a href="#cb43-46" aria-hidden="true" tabindex="-1"></a>  f_1_d <span class="sc">+</span> f_2_d</span>
<span id="cb43-47"><a href="#cb43-47" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb43-48"><a href="#cb43-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-49"><a href="#cb43-49" aria-hidden="true" tabindex="-1"></a><span class="co">#' Second derivative</span></span>
<span id="cb43-50"><a href="#cb43-50" aria-hidden="true" tabindex="-1"></a>double_gompertz_f_second_d <span class="ot">&lt;-</span> <span class="cf">function</span>(theta, x) {</span>
<span id="cb43-51"><a href="#cb43-51" aria-hidden="true" tabindex="-1"></a>  K1 <span class="ot">&lt;-</span> theta[[<span class="st">"K1"</span>]]</span>
<span id="cb43-52"><a href="#cb43-52" aria-hidden="true" tabindex="-1"></a>  tau1 <span class="ot">&lt;-</span> theta[[<span class="st">"tau1"</span>]]</span>
<span id="cb43-53"><a href="#cb43-53" aria-hidden="true" tabindex="-1"></a>  r1 <span class="ot">&lt;-</span> theta[[<span class="st">"r1"</span>]]</span>
<span id="cb43-54"><a href="#cb43-54" aria-hidden="true" tabindex="-1"></a>  K2 <span class="ot">&lt;-</span> theta[[<span class="st">"K2"</span>]]</span>
<span id="cb43-55"><a href="#cb43-55" aria-hidden="true" tabindex="-1"></a>  tau2 <span class="ot">&lt;-</span> theta[[<span class="st">"tau2"</span>]]</span>
<span id="cb43-56"><a href="#cb43-56" aria-hidden="true" tabindex="-1"></a>  r2 <span class="ot">&lt;-</span> theta[[<span class="st">"r2"</span>]]</span>
<span id="cb43-57"><a href="#cb43-57" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb43-58"><a href="#cb43-58" aria-hidden="true" tabindex="-1"></a>  <span class="sc">-</span>K1 <span class="sc">*</span> r1<span class="sc">^</span><span class="dv">2</span> <span class="sc">*</span> <span class="fu">exp</span>(<span class="sc">-</span>r1<span class="sc">*</span>(x <span class="sc">-</span> tau1)) <span class="sc">*</span> <span class="fu">exp</span>(<span class="sc">-</span><span class="fu">exp</span>(<span class="sc">-</span>r1<span class="sc">*</span>(x <span class="sc">-</span> tau1))) <span class="sc">+</span></span>
<span id="cb43-59"><a href="#cb43-59" aria-hidden="true" tabindex="-1"></a>    K1 <span class="sc">*</span> r1<span class="sc">^</span><span class="dv">2</span> <span class="sc">*</span> (<span class="fu">exp</span>( <span class="sc">-</span>r1<span class="sc">*</span>(x <span class="sc">-</span> tau1)))<span class="sc">^</span><span class="dv">2</span> <span class="sc">*</span> <span class="fu">exp</span>(<span class="sc">-</span><span class="fu">exp</span>(<span class="sc">-</span>r1<span class="sc">*</span>(x <span class="sc">-</span> tau1))) <span class="sc">-</span> </span>
<span id="cb43-60"><a href="#cb43-60" aria-hidden="true" tabindex="-1"></a>    (K2 <span class="sc">-</span> K1) <span class="sc">*</span> r2<span class="sc">^</span><span class="dv">2</span> <span class="sc">*</span> <span class="fu">exp</span>( <span class="sc">-</span>r2 <span class="sc">*</span> (x <span class="sc">-</span> tau2)) <span class="sc">*</span> <span class="fu">exp</span>( <span class="sc">-</span><span class="fu">exp</span>(<span class="sc">-</span>r2<span class="sc">*</span>(x <span class="sc">-</span> tau2))) <span class="sc">+</span></span>
<span id="cb43-61"><a href="#cb43-61" aria-hidden="true" tabindex="-1"></a>    (K2 <span class="sc">-</span> K1) <span class="sc">*</span> r2<span class="sc">^</span><span class="dv">2</span> <span class="sc">*</span> (<span class="fu">exp</span>( <span class="sc">-</span>r2 <span class="sc">*</span> (x <span class="sc">-</span> tau2)))<span class="sc">^</span><span class="dv">2</span> <span class="sc">*</span> <span class="fu">exp</span>(<span class="sc">-</span><span class="fu">exp</span>(<span class="sc">-</span>r2<span class="sc">*</span>(x<span class="sc">-</span>tau2)))</span>
<span id="cb43-62"><a href="#cb43-62" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Let us make some illustrations by varying <span class="math inline">\(r_1\)</span> and <span class="math inline">\(r_2\)</span>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>situations <span class="ot">&lt;-</span> </span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">expand_grid</span>(<span class="at">r1 =</span> <span class="fu">c</span>(.<span class="dv">2</span>, .<span class="dv">5</span>), <span class="at">r2 =</span> <span class="fu">c</span>(.<span class="dv">2</span>, .<span class="dv">5</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">K1     =</span> <span class="dv">2500</span>,</span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">K2     =</span> <span class="dv">5000</span>,</span>
<span id="cb44-6"><a href="#cb44-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">tau1   =</span> <span class="dv">20</span>,</span>
<span id="cb44-7"><a href="#cb44-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">tau2   =</span> <span class="dv">40</span></span>
<span id="cb44-8"><a href="#cb44-8" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The function that simulates <span class="math inline">\(C(t)\)</span> and its first and second derivatives with respect to time for a single scenario:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="co">#' Simulation of the logistic model for some parameters</span></span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a><span class="co">#' </span></span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a><span class="co">#' @param i row number of situations</span></span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a>simu <span class="ot">&lt;-</span> <span class="cf">function</span>(i) {</span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a>  current_params <span class="ot">&lt;-</span> situations <span class="sc">|&gt;</span> <span class="fu">slice</span>(i)</span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true" tabindex="-1"></a>  current_params <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">as_vector</span>(current_params)) <span class="sc">|&gt;</span> <span class="fu">as.list</span>()</span>
<span id="cb45-7"><a href="#cb45-7" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb45-8"><a href="#cb45-8" aria-hidden="true" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="dv">60</span></span>
<span id="cb45-9"><a href="#cb45-9" aria-hidden="true" tabindex="-1"></a>  step <span class="ot">&lt;-</span> .<span class="dv">01</span></span>
<span id="cb45-10"><a href="#cb45-10" aria-hidden="true" tabindex="-1"></a>  sim <span class="ot">&lt;-</span>  <span class="fu">double_gompertz_f</span>(</span>
<span id="cb45-11"><a href="#cb45-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">theta =</span> current_params, <span class="at">x =</span> <span class="fu">seq</span>(<span class="dv">1</span>,n, <span class="at">by =</span> step))</span>
<span id="cb45-12"><a href="#cb45-12" aria-hidden="true" tabindex="-1"></a>  simD <span class="ot">&lt;-</span>  <span class="fu">double_gompertz_f_first_d</span>(</span>
<span id="cb45-13"><a href="#cb45-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">theta =</span> current_params, <span class="at">x =</span> <span class="fu">seq</span>(<span class="dv">1</span>,n, <span class="at">by =</span> step))</span>
<span id="cb45-14"><a href="#cb45-14" aria-hidden="true" tabindex="-1"></a>  simD2 <span class="ot">&lt;-</span>  <span class="fu">double_gompertz_f_second_d</span>(</span>
<span id="cb45-15"><a href="#cb45-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">theta =</span> current_params, <span class="at">x =</span> <span class="fu">seq</span>(<span class="dv">1</span>,n, <span class="at">by =</span> step))</span>
<span id="cb45-16"><a href="#cb45-16" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb45-17"><a href="#cb45-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(</span>
<span id="cb45-18"><a href="#cb45-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">t =</span> <span class="fu">seq</span>(<span class="dv">1</span>, n, <span class="at">by =</span> step),</span>
<span id="cb45-19"><a href="#cb45-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">K1 =</span> current_params[[<span class="st">"K1"</span>]],</span>
<span id="cb45-20"><a href="#cb45-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">r1 =</span> current_params[[<span class="st">"r1"</span>]],</span>
<span id="cb45-21"><a href="#cb45-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">tau1 =</span> current_params[[<span class="st">"tau1"</span>]],</span>
<span id="cb45-22"><a href="#cb45-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">K2 =</span> current_params[[<span class="st">"K2"</span>]],</span>
<span id="cb45-23"><a href="#cb45-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">r2 =</span> current_params[<span class="st">"r2"</span>],</span>
<span id="cb45-24"><a href="#cb45-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">tau2 =</span> current_params[[<span class="st">"tau2"</span>]],</span>
<span id="cb45-25"><a href="#cb45-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">sim =</span> sim) <span class="sc">|&gt;</span> </span>
<span id="cb45-26"><a href="#cb45-26" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">simD =</span> simD,</span>
<span id="cb45-27"><a href="#cb45-27" aria-hidden="true" tabindex="-1"></a>           <span class="at">simD2 =</span> simD2)</span>
<span id="cb45-28"><a href="#cb45-28" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb45-29"><a href="#cb45-29" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Let us apply this function to all scenarios:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>simu_res <span class="ot">&lt;-</span> <span class="fu">map_df</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(situations), simu)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The thresholds:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>threshold_times <span class="ot">&lt;-</span> </span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>  simu_res <span class="sc">|&gt;</span> </span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(K1, tau1, r1, K2, tau2, r2) <span class="sc">|&gt;</span> </span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">threshold_time_1 =</span> <span class="fu">unique</span>(tau1),</span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a>            <span class="at">threshold_time_2 =</span> <span class="fu">unique</span>(tau2)) <span class="sc">|&gt;</span> </span>
<span id="cb47-6"><a href="#cb47-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">|&gt;</span> </span>
<span id="cb47-7"><a href="#cb47-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb47-8"><a href="#cb47-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">r1 =</span> <span class="fu">str_c</span>(<span class="st">"$</span><span class="sc">\\</span><span class="st">r_1 = "</span>, r1, <span class="st">"$"</span>),</span>
<span id="cb47-9"><a href="#cb47-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">r2 =</span> <span class="fu">str_c</span>(<span class="st">"$</span><span class="sc">\\</span><span class="st">r_2 = "</span>, r2, <span class="st">"$"</span>)</span>
<span id="cb47-10"><a href="#cb47-10" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'K1', 'tau1', 'r1', 'K2', 'tau2'. You can
override using the `.groups` argument.</code></pre>
</div>
</div>
<p>And the the plots:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>p_simu_double_gompertz <span class="ot">&lt;-</span> </span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(</span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span>  simu_res <span class="sc">|&gt;</span> </span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a>      <span class="fu">mutate</span>(<span class="at">r1 =</span> <span class="fu">str_c</span>(<span class="st">"$</span><span class="sc">\\</span><span class="st">r_1 = "</span>, r1, <span class="st">"$"</span>),</span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a>             <span class="at">r2 =</span> <span class="fu">str_c</span>(<span class="st">"$</span><span class="sc">\\</span><span class="st">r_2 = "</span>, r2, <span class="st">"$"</span>)</span>
<span id="cb49-6"><a href="#cb49-6" aria-hidden="true" tabindex="-1"></a>      ),</span>
<span id="cb49-7"><a href="#cb49-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> t)) <span class="sc">+</span></span>
<span id="cb49-8"><a href="#cb49-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> sim, <span class="at">linetype =</span> <span class="st">"sim"</span>)) <span class="sc">+</span></span>
<span id="cb49-9"><a href="#cb49-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> simD<span class="sc">*</span><span class="dv">10</span>, <span class="at">linetype =</span> <span class="st">"simD"</span>)) <span class="sc">+</span></span>
<span id="cb49-10"><a href="#cb49-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> simD2<span class="sc">*</span><span class="dv">10</span>, <span class="at">linetype =</span> <span class="st">"simD2"</span>)) <span class="sc">+</span></span>
<span id="cb49-11"><a href="#cb49-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(</span>
<span id="cb49-12"><a href="#cb49-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> threshold_times, </span>
<span id="cb49-13"><a href="#cb49-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">xintercept =</span> threshold_time_1),</span>
<span id="cb49-14"><a href="#cb49-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">colour =</span> <span class="st">"red"</span>, <span class="at">linetype =</span> <span class="st">"dotted"</span>) <span class="sc">+</span></span>
<span id="cb49-15"><a href="#cb49-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(</span>
<span id="cb49-16"><a href="#cb49-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> threshold_times,</span>
<span id="cb49-17"><a href="#cb49-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">xintercept =</span> threshold_time_2),</span>
<span id="cb49-18"><a href="#cb49-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">colour =</span> <span class="st">"red"</span>, <span class="at">linetype =</span> <span class="st">"dotted"</span>) <span class="sc">+</span></span>
<span id="cb49-19"><a href="#cb49-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(</span>
<span id="cb49-20"><a href="#cb49-20" aria-hidden="true" tabindex="-1"></a>    r2 <span class="sc">~</span> r1,</span>
<span id="cb49-21"><a href="#cb49-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">labeller =</span> <span class="fu">as_labeller</span>(</span>
<span id="cb49-22"><a href="#cb49-22" aria-hidden="true" tabindex="-1"></a>      latex2exp<span class="sc">::</span>TeX, </span>
<span id="cb49-23"><a href="#cb49-23" aria-hidden="true" tabindex="-1"></a>      <span class="at">default =</span> label_parsed</span>
<span id="cb49-24"><a href="#cb49-24" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb49-25"><a href="#cb49-25" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb49-26"><a href="#cb49-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Time"</span>, <span class="at">y =</span> latex2exp<span class="sc">::</span><span class="fu">TeX</span>(<span class="st">"$F(t)$"</span>)) <span class="sc">+</span></span>
<span id="cb49-27"><a href="#cb49-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(</span>
<span id="cb49-28"><a href="#cb49-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">labels =</span> comma,</span>
<span id="cb49-29"><a href="#cb49-29" aria-hidden="true" tabindex="-1"></a>    <span class="at">sec.axis =</span> <span class="fu">sec_axis</span>(</span>
<span id="cb49-30"><a href="#cb49-30" aria-hidden="true" tabindex="-1"></a>      <span class="sc">~</span>.<span class="sc">/</span><span class="dv">10</span>, </span>
<span id="cb49-31"><a href="#cb49-31" aria-hidden="true" tabindex="-1"></a>      <span class="at">name =</span> latex2exp<span class="sc">::</span><span class="fu">TeX</span>(</span>
<span id="cb49-32"><a href="#cb49-32" aria-hidden="true" tabindex="-1"></a>        <span class="st">"$</span><span class="sc">\\</span><span class="st">partial F(t) / </span><span class="sc">\\</span><span class="st">partial t$, $</span><span class="sc">\\</span><span class="st">partial^2 F(t) / </span><span class="sc">\\</span><span class="st">partial t^2$"</span></span>
<span id="cb49-33"><a href="#cb49-33" aria-hidden="true" tabindex="-1"></a>      ),</span>
<span id="cb49-34"><a href="#cb49-34" aria-hidden="true" tabindex="-1"></a>      <span class="at">labels =</span> comma)) <span class="sc">+</span></span>
<span id="cb49-35"><a href="#cb49-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_linetype_manual</span>(</span>
<span id="cb49-36"><a href="#cb49-36" aria-hidden="true" tabindex="-1"></a>    <span class="cn">NULL</span>,</span>
<span id="cb49-37"><a href="#cb49-37" aria-hidden="true" tabindex="-1"></a>    <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"sim"</span> <span class="ot">=</span> <span class="st">"solid"</span>, <span class="st">"simD"</span> <span class="ot">=</span> <span class="st">"dashed"</span>, <span class="st">"simD2"</span> <span class="ot">=</span> <span class="st">"dotdash"</span>),</span>
<span id="cb49-38"><a href="#cb49-38" aria-hidden="true" tabindex="-1"></a>    <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"sim"</span> <span class="ot">=</span> latex2exp<span class="sc">::</span><span class="fu">TeX</span>(<span class="st">"$F(t)$"</span>),</span>
<span id="cb49-39"><a href="#cb49-39" aria-hidden="true" tabindex="-1"></a>               <span class="st">"simD"</span> <span class="ot">=</span> latex2exp<span class="sc">::</span><span class="fu">TeX</span>(<span class="st">"$</span><span class="sc">\\</span><span class="st">partial F(t) / </span><span class="sc">\\</span><span class="st">partial t$"</span>),</span>
<span id="cb49-40"><a href="#cb49-40" aria-hidden="true" tabindex="-1"></a>               <span class="st">"simD2"</span> <span class="ot">=</span> latex2exp<span class="sc">::</span><span class="fu">TeX</span>(<span class="st">"$</span><span class="sc">\\</span><span class="st">partial^2 F(t) / </span><span class="sc">\\</span><span class="st">partial t^2$"</span>))</span>
<span id="cb49-41"><a href="#cb49-41" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb49-42"><a href="#cb49-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.ticks.y =</span> <span class="fu">element_blank</span>())</span>
<span id="cb49-43"><a href="#cb49-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-44"><a href="#cb49-44" aria-hidden="true" tabindex="-1"></a>p_simu_double_gompertz <span class="sc">+</span></span>
<span id="cb49-45"><a href="#cb49-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb49-46"><a href="#cb49-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-illustration-double-gompertz-model" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="phenomeological-background_files/figure-html/fig-illustration-double-gompertz-model-1.png" class="img-fluid figure-img" width="672"></p>
<p></p><figcaption class="figure-caption">Figure&nbsp;6.6: Illustration of a Double Gompertz model for different values for <span class="math inline">\(r_1\)</span> and <span class="math inline">\(r_2\)</span>, with <span class="math inline">\(K_1=2,500\)</span>, <span class="math inline">\(K_2 = 5,000\)</span>, <span class="math inline">\(\tau_1 = 20\)</span>, and <span class="math inline">\(\tau_2 = 40\)</span></figcaption><p></p>
</figure>
</div>
</div>
</div>
</section>
<section id="double-richards-model" class="level3" data-number="6.2.3">
<h3 data-number="6.2.3" class="anchored" data-anchor-id="double-richards-model"><span class="header-section-number">6.2.3</span> Double Richards Model</h3>
<p>The double Richards function, its first and second derivatives with respect to time can be coded as follows:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="co">#' Double Richards</span></span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a><span class="co">#' </span></span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>double_richards_f <span class="ot">&lt;-</span> <span class="cf">function</span>(theta, x) {</span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a>  K1 <span class="ot">&lt;-</span> theta[[<span class="st">"K1"</span>]]</span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a>  tau1 <span class="ot">&lt;-</span> theta[[<span class="st">"tau1"</span>]]</span>
<span id="cb50-6"><a href="#cb50-6" aria-hidden="true" tabindex="-1"></a>  r1 <span class="ot">&lt;-</span> theta[[<span class="st">"r1"</span>]]</span>
<span id="cb50-7"><a href="#cb50-7" aria-hidden="true" tabindex="-1"></a>  delta1 <span class="ot">&lt;-</span> theta[[<span class="st">"delta1"</span>]]</span>
<span id="cb50-8"><a href="#cb50-8" aria-hidden="true" tabindex="-1"></a>  K2 <span class="ot">&lt;-</span> theta[[<span class="st">"K2"</span>]]</span>
<span id="cb50-9"><a href="#cb50-9" aria-hidden="true" tabindex="-1"></a>  tau2 <span class="ot">&lt;-</span> theta[[<span class="st">"tau2"</span>]]</span>
<span id="cb50-10"><a href="#cb50-10" aria-hidden="true" tabindex="-1"></a>  r2 <span class="ot">&lt;-</span> theta[[<span class="st">"r2"</span>]]</span>
<span id="cb50-11"><a href="#cb50-11" aria-hidden="true" tabindex="-1"></a>  delta2 <span class="ot">&lt;-</span> theta[[<span class="st">"delta2"</span>]]</span>
<span id="cb50-12"><a href="#cb50-12" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb50-13"><a href="#cb50-13" aria-hidden="true" tabindex="-1"></a>  K1 <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">+</span> delta1 <span class="sc">*</span> <span class="fu">exp</span>(<span class="sc">-</span>r1 <span class="sc">*</span> (x <span class="sc">-</span> tau1)))<span class="sc">^</span>(<span class="sc">-</span><span class="dv">1</span> <span class="sc">/</span> delta1) <span class="sc">+</span></span>
<span id="cb50-14"><a href="#cb50-14" aria-hidden="true" tabindex="-1"></a>    (K2 <span class="sc">-</span> K1) <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">+</span> delta2 <span class="sc">*</span> <span class="fu">exp</span>(<span class="sc">-</span>r2 <span class="sc">*</span> (x <span class="sc">-</span> tau2)))<span class="sc">^</span>(<span class="sc">-</span><span class="dv">1</span> <span class="sc">/</span> delta2)</span>
<span id="cb50-15"><a href="#cb50-15" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb50-16"><a href="#cb50-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-17"><a href="#cb50-17" aria-hidden="true" tabindex="-1"></a><span class="co">#' Double Richards in two parts</span></span>
<span id="cb50-18"><a href="#cb50-18" aria-hidden="true" tabindex="-1"></a><span class="co">#' </span></span>
<span id="cb50-19"><a href="#cb50-19" aria-hidden="true" tabindex="-1"></a>double_richards_f_2 <span class="ot">&lt;-</span> <span class="cf">function</span>(theta, x) {</span>
<span id="cb50-20"><a href="#cb50-20" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb50-21"><a href="#cb50-21" aria-hidden="true" tabindex="-1"></a>  K1 <span class="ot">&lt;-</span> theta[[<span class="st">"K1"</span>]]</span>
<span id="cb50-22"><a href="#cb50-22" aria-hidden="true" tabindex="-1"></a>  tau1 <span class="ot">&lt;-</span> theta[[<span class="st">"tau1"</span>]]</span>
<span id="cb50-23"><a href="#cb50-23" aria-hidden="true" tabindex="-1"></a>  r1 <span class="ot">&lt;-</span> theta[[<span class="st">"r1"</span>]]</span>
<span id="cb50-24"><a href="#cb50-24" aria-hidden="true" tabindex="-1"></a>  delta1 <span class="ot">&lt;-</span> theta[[<span class="st">"delta1"</span>]]</span>
<span id="cb50-25"><a href="#cb50-25" aria-hidden="true" tabindex="-1"></a>  K2 <span class="ot">&lt;-</span> theta[[<span class="st">"K2"</span>]]</span>
<span id="cb50-26"><a href="#cb50-26" aria-hidden="true" tabindex="-1"></a>  tau2 <span class="ot">&lt;-</span> theta[[<span class="st">"tau2"</span>]]</span>
<span id="cb50-27"><a href="#cb50-27" aria-hidden="true" tabindex="-1"></a>  r2 <span class="ot">&lt;-</span> theta[[<span class="st">"r2"</span>]]</span>
<span id="cb50-28"><a href="#cb50-28" aria-hidden="true" tabindex="-1"></a>  delta2 <span class="ot">&lt;-</span> theta[[<span class="st">"delta2"</span>]]</span>
<span id="cb50-29"><a href="#cb50-29" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb50-30"><a href="#cb50-30" aria-hidden="true" tabindex="-1"></a>  f_1 <span class="ot">&lt;-</span> K1 <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">+</span> delta1 <span class="sc">*</span> <span class="fu">exp</span>(<span class="sc">-</span>r1 <span class="sc">*</span> (x <span class="sc">-</span> tau1)))<span class="sc">^</span>(<span class="sc">-</span><span class="dv">1</span> <span class="sc">/</span> delta1)</span>
<span id="cb50-31"><a href="#cb50-31" aria-hidden="true" tabindex="-1"></a>  f_2 <span class="ot">&lt;-</span> (K2 <span class="sc">-</span> K1) <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">+</span> delta2 <span class="sc">*</span> <span class="fu">exp</span>(<span class="sc">-</span>r2 <span class="sc">*</span> (x <span class="sc">-</span> tau2)))<span class="sc">^</span>(<span class="sc">-</span><span class="dv">1</span> <span class="sc">/</span> delta2)</span>
<span id="cb50-32"><a href="#cb50-32" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb50-33"><a href="#cb50-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(<span class="at">x =</span> x, <span class="at">f_1 =</span> f_1, <span class="at">f_2 =</span> f_2)</span>
<span id="cb50-34"><a href="#cb50-34" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb50-35"><a href="#cb50-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-36"><a href="#cb50-36" aria-hidden="true" tabindex="-1"></a><span class="co">#' First derivative</span></span>
<span id="cb50-37"><a href="#cb50-37" aria-hidden="true" tabindex="-1"></a><span class="co">#' </span></span>
<span id="cb50-38"><a href="#cb50-38" aria-hidden="true" tabindex="-1"></a>double_richards_f_first_d <span class="ot">&lt;-</span> <span class="cf">function</span>(theta, x) {</span>
<span id="cb50-39"><a href="#cb50-39" aria-hidden="true" tabindex="-1"></a>  K1 <span class="ot">&lt;-</span> theta[[<span class="st">"K1"</span>]]</span>
<span id="cb50-40"><a href="#cb50-40" aria-hidden="true" tabindex="-1"></a>  tau1 <span class="ot">&lt;-</span> theta[[<span class="st">"tau1"</span>]]</span>
<span id="cb50-41"><a href="#cb50-41" aria-hidden="true" tabindex="-1"></a>  r1 <span class="ot">&lt;-</span> theta[[<span class="st">"r1"</span>]]</span>
<span id="cb50-42"><a href="#cb50-42" aria-hidden="true" tabindex="-1"></a>  delta1 <span class="ot">&lt;-</span> theta[[<span class="st">"delta1"</span>]]</span>
<span id="cb50-43"><a href="#cb50-43" aria-hidden="true" tabindex="-1"></a>  K2 <span class="ot">&lt;-</span> theta[[<span class="st">"K2"</span>]]</span>
<span id="cb50-44"><a href="#cb50-44" aria-hidden="true" tabindex="-1"></a>  tau2 <span class="ot">&lt;-</span> theta[[<span class="st">"tau2"</span>]]</span>
<span id="cb50-45"><a href="#cb50-45" aria-hidden="true" tabindex="-1"></a>  r2 <span class="ot">&lt;-</span> theta[[<span class="st">"r2"</span>]]</span>
<span id="cb50-46"><a href="#cb50-46" aria-hidden="true" tabindex="-1"></a>  delta2 <span class="ot">&lt;-</span> theta[[<span class="st">"delta2"</span>]]</span>
<span id="cb50-47"><a href="#cb50-47" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb50-48"><a href="#cb50-48" aria-hidden="true" tabindex="-1"></a>  r1 <span class="sc">*</span> K1 <span class="sc">*</span> <span class="fu">exp</span>(<span class="sc">-</span>r1 <span class="sc">*</span> (x <span class="sc">-</span> tau1)) <span class="sc">*</span> </span>
<span id="cb50-49"><a href="#cb50-49" aria-hidden="true" tabindex="-1"></a>    (delta1 <span class="sc">*</span> <span class="fu">exp</span>(<span class="sc">-</span>r1 <span class="sc">*</span> (x <span class="sc">-</span> tau1)) <span class="sc">+</span> <span class="dv">1</span>)<span class="sc">^</span>(<span class="sc">-</span><span class="dv">1</span><span class="sc">/</span>delta1 <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb50-50"><a href="#cb50-50" aria-hidden="true" tabindex="-1"></a>    r2 <span class="sc">*</span> (K2<span class="sc">-</span>K1) <span class="sc">*</span> <span class="fu">exp</span>(<span class="sc">-</span>r2 <span class="sc">*</span> (x <span class="sc">-</span> tau2)) <span class="sc">*</span> </span>
<span id="cb50-51"><a href="#cb50-51" aria-hidden="true" tabindex="-1"></a>    (delta2 <span class="sc">*</span> <span class="fu">exp</span>(<span class="sc">-</span>r2 <span class="sc">*</span> (x <span class="sc">-</span> tau2)) <span class="sc">+</span> <span class="dv">1</span>)<span class="sc">^</span>(<span class="sc">-</span><span class="dv">1</span><span class="sc">/</span>delta2 <span class="sc">-</span> <span class="dv">1</span>)</span>
<span id="cb50-52"><a href="#cb50-52" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb50-53"><a href="#cb50-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-54"><a href="#cb50-54" aria-hidden="true" tabindex="-1"></a><span class="co">#' Second derivative</span></span>
<span id="cb50-55"><a href="#cb50-55" aria-hidden="true" tabindex="-1"></a><span class="co">#' </span></span>
<span id="cb50-56"><a href="#cb50-56" aria-hidden="true" tabindex="-1"></a>double_richards_f_second_d <span class="ot">&lt;-</span> <span class="cf">function</span>(theta, x) {</span>
<span id="cb50-57"><a href="#cb50-57" aria-hidden="true" tabindex="-1"></a>  K1 <span class="ot">&lt;-</span> theta[[<span class="st">"K1"</span>]]</span>
<span id="cb50-58"><a href="#cb50-58" aria-hidden="true" tabindex="-1"></a>  tau1 <span class="ot">&lt;-</span> theta[[<span class="st">"tau1"</span>]]</span>
<span id="cb50-59"><a href="#cb50-59" aria-hidden="true" tabindex="-1"></a>  r1 <span class="ot">&lt;-</span> theta[[<span class="st">"r1"</span>]]</span>
<span id="cb50-60"><a href="#cb50-60" aria-hidden="true" tabindex="-1"></a>  delta1 <span class="ot">&lt;-</span> theta[[<span class="st">"delta1"</span>]]</span>
<span id="cb50-61"><a href="#cb50-61" aria-hidden="true" tabindex="-1"></a>  K2 <span class="ot">&lt;-</span> theta[[<span class="st">"K2"</span>]]</span>
<span id="cb50-62"><a href="#cb50-62" aria-hidden="true" tabindex="-1"></a>  tau2 <span class="ot">&lt;-</span> theta[[<span class="st">"tau2"</span>]]</span>
<span id="cb50-63"><a href="#cb50-63" aria-hidden="true" tabindex="-1"></a>  r2 <span class="ot">&lt;-</span> theta[[<span class="st">"r2"</span>]]</span>
<span id="cb50-64"><a href="#cb50-64" aria-hidden="true" tabindex="-1"></a>  delta2 <span class="ot">&lt;-</span> theta[[<span class="st">"delta2"</span>]]</span>
<span id="cb50-65"><a href="#cb50-65" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb50-66"><a href="#cb50-66" aria-hidden="true" tabindex="-1"></a>  K1 <span class="sc">*</span> (r1<span class="sc">^</span><span class="dv">2</span> <span class="sc">*</span> (<span class="sc">-</span><span class="dv">1</span><span class="sc">/</span>delta1 <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">*</span> delta1 <span class="sc">*</span> (<span class="sc">-</span><span class="fu">exp</span>(<span class="sc">-</span><span class="dv">2</span> <span class="sc">*</span> r1 <span class="sc">*</span> (x <span class="sc">-</span> tau1))) <span class="sc">*</span> </span>
<span id="cb50-67"><a href="#cb50-67" aria-hidden="true" tabindex="-1"></a>          (delta1 <span class="sc">*</span> <span class="fu">exp</span>(<span class="sc">-</span>r1 <span class="sc">*</span> (x <span class="sc">-</span> tau1)) <span class="sc">+</span> <span class="dv">1</span>)<span class="sc">^</span>(<span class="sc">-</span><span class="dv">1</span><span class="sc">/</span>delta1 <span class="sc">-</span> <span class="dv">2</span>) <span class="sc">-</span> r1<span class="sc">^</span><span class="dv">2</span> <span class="sc">*</span> </span>
<span id="cb50-68"><a href="#cb50-68" aria-hidden="true" tabindex="-1"></a>          <span class="fu">exp</span>(<span class="sc">-</span>r1 <span class="sc">*</span> (x <span class="sc">-</span> tau1)) <span class="sc">*</span> </span>
<span id="cb50-69"><a href="#cb50-69" aria-hidden="true" tabindex="-1"></a>          (delta1 <span class="sc">*</span> <span class="fu">exp</span>(<span class="sc">-</span>r1 <span class="sc">*</span> (x <span class="sc">-</span> tau1)) <span class="sc">+</span> <span class="dv">1</span>)<span class="sc">^</span>(<span class="sc">-</span><span class="dv">1</span><span class="sc">/</span>delta1 <span class="sc">-</span> <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb50-70"><a href="#cb50-70" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb50-71"><a href="#cb50-71" aria-hidden="true" tabindex="-1"></a>    (K2 <span class="sc">-</span> K1) <span class="sc">*</span> </span>
<span id="cb50-72"><a href="#cb50-72" aria-hidden="true" tabindex="-1"></a>    (r2<span class="sc">^</span><span class="dv">2</span> <span class="sc">*</span> (<span class="sc">-</span><span class="dv">1</span> <span class="sc">/</span> delta2 <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">*</span> </span>
<span id="cb50-73"><a href="#cb50-73" aria-hidden="true" tabindex="-1"></a>       delta2 <span class="sc">*</span> (<span class="sc">-</span><span class="fu">exp</span>(<span class="sc">-</span><span class="dv">2</span> <span class="sc">*</span> r2 <span class="sc">*</span> (x <span class="sc">-</span> tau2))) <span class="sc">*</span> </span>
<span id="cb50-74"><a href="#cb50-74" aria-hidden="true" tabindex="-1"></a>       (delta2 <span class="sc">*</span> <span class="fu">exp</span>(<span class="sc">-</span>r2 <span class="sc">*</span> (x <span class="sc">-</span> tau2)) <span class="sc">+</span> <span class="dv">1</span>)<span class="sc">^</span>(<span class="sc">-</span><span class="dv">1</span><span class="sc">/</span>delta2 <span class="sc">-</span> <span class="dv">2</span>) <span class="sc">-</span> </span>
<span id="cb50-75"><a href="#cb50-75" aria-hidden="true" tabindex="-1"></a>       r2<span class="sc">^</span><span class="dv">2</span> <span class="sc">*</span> </span>
<span id="cb50-76"><a href="#cb50-76" aria-hidden="true" tabindex="-1"></a>       <span class="fu">exp</span>(<span class="sc">-</span>r2 <span class="sc">*</span> (x <span class="sc">-</span> tau2)) <span class="sc">*</span> </span>
<span id="cb50-77"><a href="#cb50-77" aria-hidden="true" tabindex="-1"></a>       (delta2 <span class="sc">*</span> <span class="fu">exp</span>(<span class="sc">-</span>r2 <span class="sc">*</span> (x <span class="sc">-</span> tau2)) <span class="sc">+</span> <span class="dv">1</span>)<span class="sc">^</span>(<span class="sc">-</span><span class="dv">1</span><span class="sc">/</span>delta2 <span class="sc">-</span> <span class="dv">1</span>))</span>
<span id="cb50-78"><a href="#cb50-78" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Let us make some illustrations by varying <span class="math inline">\(r_1\)</span> and <span class="math inline">\(r_2\)</span>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>situations <span class="ot">&lt;-</span> </span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">expand_grid</span>(<span class="at">r1 =</span> <span class="fu">c</span>(.<span class="dv">2</span>, .<span class="dv">5</span>), <span class="at">r2 =</span> <span class="fu">c</span>(.<span class="dv">2</span>, .<span class="dv">5</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">K1     =</span> <span class="dv">2500</span>,</span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">K2     =</span> <span class="dv">5000</span>,</span>
<span id="cb51-6"><a href="#cb51-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">tau1   =</span> <span class="dv">20</span>,</span>
<span id="cb51-7"><a href="#cb51-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">tau2   =</span> <span class="dv">40</span>,</span>
<span id="cb51-8"><a href="#cb51-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">delta1 =</span> .<span class="dv">5</span>,</span>
<span id="cb51-9"><a href="#cb51-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">delta2 =</span> .<span class="dv">5</span></span>
<span id="cb51-10"><a href="#cb51-10" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The function that simulates <span class="math inline">\(C(t)\)</span> and its first and second derivatives with respect to time for a single scenario:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="co">#' Simulation of the logistic model for some parameters</span></span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a><span class="co">#' </span></span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a><span class="co">#' @param i row number of situations</span></span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a>simu <span class="ot">&lt;-</span> <span class="cf">function</span>(i) {</span>
<span id="cb52-5"><a href="#cb52-5" aria-hidden="true" tabindex="-1"></a>  current_params <span class="ot">&lt;-</span> situations <span class="sc">|&gt;</span> <span class="fu">slice</span>(i)</span>
<span id="cb52-6"><a href="#cb52-6" aria-hidden="true" tabindex="-1"></a>  current_params <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">as_vector</span>(current_params)) <span class="sc">|&gt;</span> <span class="fu">as.list</span>()</span>
<span id="cb52-7"><a href="#cb52-7" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb52-8"><a href="#cb52-8" aria-hidden="true" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="dv">60</span></span>
<span id="cb52-9"><a href="#cb52-9" aria-hidden="true" tabindex="-1"></a>  step <span class="ot">&lt;-</span> .<span class="dv">01</span></span>
<span id="cb52-10"><a href="#cb52-10" aria-hidden="true" tabindex="-1"></a>  sim <span class="ot">&lt;-</span>  <span class="fu">double_richards_f</span>(</span>
<span id="cb52-11"><a href="#cb52-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">theta =</span> current_params, <span class="at">x =</span> <span class="fu">seq</span>(<span class="dv">1</span>,n, <span class="at">by =</span> step))</span>
<span id="cb52-12"><a href="#cb52-12" aria-hidden="true" tabindex="-1"></a>  simD <span class="ot">&lt;-</span>  <span class="fu">double_richards_f_first_d</span>(</span>
<span id="cb52-13"><a href="#cb52-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">theta =</span> current_params, <span class="at">x =</span> <span class="fu">seq</span>(<span class="dv">1</span>,n, <span class="at">by =</span> step))</span>
<span id="cb52-14"><a href="#cb52-14" aria-hidden="true" tabindex="-1"></a>  simD2 <span class="ot">&lt;-</span>  <span class="fu">double_richards_f_second_d</span>(</span>
<span id="cb52-15"><a href="#cb52-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">theta =</span> current_params, <span class="at">x =</span> <span class="fu">seq</span>(<span class="dv">1</span>,n, <span class="at">by =</span> step))</span>
<span id="cb52-16"><a href="#cb52-16" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb52-17"><a href="#cb52-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(</span>
<span id="cb52-18"><a href="#cb52-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">t =</span> <span class="fu">seq</span>(<span class="dv">1</span>, n, <span class="at">by =</span> step),</span>
<span id="cb52-19"><a href="#cb52-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">K1 =</span> current_params[[<span class="st">"K1"</span>]],</span>
<span id="cb52-20"><a href="#cb52-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">r1 =</span> current_params[[<span class="st">"r1"</span>]],</span>
<span id="cb52-21"><a href="#cb52-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">tau1 =</span> current_params[[<span class="st">"tau1"</span>]],</span>
<span id="cb52-22"><a href="#cb52-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">delta1 =</span> current_params[[<span class="st">"delta1"</span>]],</span>
<span id="cb52-23"><a href="#cb52-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">K2 =</span> current_params[[<span class="st">"K2"</span>]],</span>
<span id="cb52-24"><a href="#cb52-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">r2 =</span> current_params[<span class="st">"r2"</span>],</span>
<span id="cb52-25"><a href="#cb52-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">tau2 =</span> current_params[[<span class="st">"tau2"</span>]],</span>
<span id="cb52-26"><a href="#cb52-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">delta2 =</span> current_params[[<span class="st">"delta2"</span>]],</span>
<span id="cb52-27"><a href="#cb52-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">sim =</span> sim) <span class="sc">|&gt;</span> </span>
<span id="cb52-28"><a href="#cb52-28" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">simD =</span> simD,</span>
<span id="cb52-29"><a href="#cb52-29" aria-hidden="true" tabindex="-1"></a>           <span class="at">simD2 =</span> simD2)</span>
<span id="cb52-30"><a href="#cb52-30" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb52-31"><a href="#cb52-31" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Let us apply this function to all scenarios:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a>simu_res <span class="ot">&lt;-</span> <span class="fu">map_df</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(situations), simu)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The thresholds:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>threshold_times <span class="ot">&lt;-</span> </span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a>  simu_res <span class="sc">|&gt;</span> </span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(K1, tau1, r1, K2, tau2, r2, delta1, delta2) <span class="sc">|&gt;</span> </span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">threshold_time_1 =</span> <span class="fu">unique</span>(tau1),</span>
<span id="cb54-5"><a href="#cb54-5" aria-hidden="true" tabindex="-1"></a>            <span class="at">threshold_time_2 =</span> <span class="fu">unique</span>(tau2)) <span class="sc">|&gt;</span> </span>
<span id="cb54-6"><a href="#cb54-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">|&gt;</span> </span>
<span id="cb54-7"><a href="#cb54-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb54-8"><a href="#cb54-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">r1 =</span> <span class="fu">str_c</span>(<span class="st">"$</span><span class="sc">\\</span><span class="st">r_1 = "</span>, r1, <span class="st">"$"</span>),</span>
<span id="cb54-9"><a href="#cb54-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">r2 =</span> <span class="fu">str_c</span>(<span class="st">"$</span><span class="sc">\\</span><span class="st">r_2 = "</span>, r2, <span class="st">"$"</span>)</span>
<span id="cb54-10"><a href="#cb54-10" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'K1', 'tau1', 'r1', 'K2', 'tau2', 'r2',
'delta1'. You can override using the `.groups` argument.</code></pre>
</div>
</div>
<p>And the the plots:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a>p_simu_double_richards <span class="ot">&lt;-</span> </span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(</span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span>  simu_res <span class="sc">|&gt;</span> </span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a>      <span class="fu">mutate</span>(<span class="at">r1 =</span> <span class="fu">str_c</span>(<span class="st">"$</span><span class="sc">\\</span><span class="st">r_1 = "</span>, r1, <span class="st">"$"</span>),</span>
<span id="cb56-5"><a href="#cb56-5" aria-hidden="true" tabindex="-1"></a>             <span class="at">r2 =</span> <span class="fu">str_c</span>(<span class="st">"$</span><span class="sc">\\</span><span class="st">r_2 = "</span>, r2, <span class="st">"$"</span>)</span>
<span id="cb56-6"><a href="#cb56-6" aria-hidden="true" tabindex="-1"></a>      ),</span>
<span id="cb56-7"><a href="#cb56-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> t)) <span class="sc">+</span></span>
<span id="cb56-8"><a href="#cb56-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> sim, <span class="at">linetype =</span> <span class="st">"sim"</span>)) <span class="sc">+</span></span>
<span id="cb56-9"><a href="#cb56-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> simD<span class="sc">*</span><span class="dv">10</span>, <span class="at">linetype =</span> <span class="st">"simD"</span>)) <span class="sc">+</span></span>
<span id="cb56-10"><a href="#cb56-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> simD2<span class="sc">*</span><span class="dv">10</span>, <span class="at">linetype =</span> <span class="st">"simD2"</span>)) <span class="sc">+</span></span>
<span id="cb56-11"><a href="#cb56-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(</span>
<span id="cb56-12"><a href="#cb56-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> threshold_times, </span>
<span id="cb56-13"><a href="#cb56-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">xintercept =</span> threshold_time_1),</span>
<span id="cb56-14"><a href="#cb56-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">colour =</span> <span class="st">"red"</span>, <span class="at">linetype =</span> <span class="st">"dotted"</span>) <span class="sc">+</span></span>
<span id="cb56-15"><a href="#cb56-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(</span>
<span id="cb56-16"><a href="#cb56-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> threshold_times,</span>
<span id="cb56-17"><a href="#cb56-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">xintercept =</span> threshold_time_2),</span>
<span id="cb56-18"><a href="#cb56-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">colour =</span> <span class="st">"red"</span>, <span class="at">linetype =</span> <span class="st">"dotted"</span>) <span class="sc">+</span></span>
<span id="cb56-19"><a href="#cb56-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(</span>
<span id="cb56-20"><a href="#cb56-20" aria-hidden="true" tabindex="-1"></a>    r2 <span class="sc">~</span> r1,</span>
<span id="cb56-21"><a href="#cb56-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">labeller =</span> <span class="fu">as_labeller</span>(</span>
<span id="cb56-22"><a href="#cb56-22" aria-hidden="true" tabindex="-1"></a>      latex2exp<span class="sc">::</span>TeX, </span>
<span id="cb56-23"><a href="#cb56-23" aria-hidden="true" tabindex="-1"></a>      <span class="at">default =</span> label_parsed</span>
<span id="cb56-24"><a href="#cb56-24" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb56-25"><a href="#cb56-25" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb56-26"><a href="#cb56-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Time"</span>, <span class="at">y =</span> latex2exp<span class="sc">::</span><span class="fu">TeX</span>(<span class="st">"$F(t)$"</span>)) <span class="sc">+</span></span>
<span id="cb56-27"><a href="#cb56-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(</span>
<span id="cb56-28"><a href="#cb56-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">labels =</span> comma,</span>
<span id="cb56-29"><a href="#cb56-29" aria-hidden="true" tabindex="-1"></a>    <span class="at">sec.axis =</span> <span class="fu">sec_axis</span>(</span>
<span id="cb56-30"><a href="#cb56-30" aria-hidden="true" tabindex="-1"></a>      <span class="sc">~</span>.<span class="sc">/</span><span class="dv">10</span>, </span>
<span id="cb56-31"><a href="#cb56-31" aria-hidden="true" tabindex="-1"></a>      <span class="at">name =</span> latex2exp<span class="sc">::</span><span class="fu">TeX</span>(</span>
<span id="cb56-32"><a href="#cb56-32" aria-hidden="true" tabindex="-1"></a>        <span class="st">"$</span><span class="sc">\\</span><span class="st">partial F(t) / </span><span class="sc">\\</span><span class="st">partial t$, $</span><span class="sc">\\</span><span class="st">partial^2 F(t) / </span><span class="sc">\\</span><span class="st">partial t^2$"</span></span>
<span id="cb56-33"><a href="#cb56-33" aria-hidden="true" tabindex="-1"></a>      ),</span>
<span id="cb56-34"><a href="#cb56-34" aria-hidden="true" tabindex="-1"></a>      <span class="at">labels =</span> comma)) <span class="sc">+</span></span>
<span id="cb56-35"><a href="#cb56-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_linetype_manual</span>(</span>
<span id="cb56-36"><a href="#cb56-36" aria-hidden="true" tabindex="-1"></a>    <span class="cn">NULL</span>,</span>
<span id="cb56-37"><a href="#cb56-37" aria-hidden="true" tabindex="-1"></a>    <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"sim"</span> <span class="ot">=</span> <span class="st">"solid"</span>, <span class="st">"simD"</span> <span class="ot">=</span> <span class="st">"dashed"</span>, <span class="st">"simD2"</span> <span class="ot">=</span> <span class="st">"dotdash"</span>),</span>
<span id="cb56-38"><a href="#cb56-38" aria-hidden="true" tabindex="-1"></a>    <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"sim"</span> <span class="ot">=</span> latex2exp<span class="sc">::</span><span class="fu">TeX</span>(<span class="st">"$F(t)$"</span>),</span>
<span id="cb56-39"><a href="#cb56-39" aria-hidden="true" tabindex="-1"></a>               <span class="st">"simD"</span> <span class="ot">=</span> latex2exp<span class="sc">::</span><span class="fu">TeX</span>(<span class="st">"$</span><span class="sc">\\</span><span class="st">partial F(t) / </span><span class="sc">\\</span><span class="st">partial t$"</span>),</span>
<span id="cb56-40"><a href="#cb56-40" aria-hidden="true" tabindex="-1"></a>               <span class="st">"simD2"</span> <span class="ot">=</span> latex2exp<span class="sc">::</span><span class="fu">TeX</span>(<span class="st">"$</span><span class="sc">\\</span><span class="st">partial^2 F(t) / </span><span class="sc">\\</span><span class="st">partial t^2$"</span>))</span>
<span id="cb56-41"><a href="#cb56-41" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb56-42"><a href="#cb56-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.ticks.y =</span> <span class="fu">element_blank</span>())</span>
<span id="cb56-43"><a href="#cb56-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-44"><a href="#cb56-44" aria-hidden="true" tabindex="-1"></a>p_simu_double_richards <span class="sc">+</span></span>
<span id="cb56-45"><a href="#cb56-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb56-46"><a href="#cb56-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-illustration-double-richards-model" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="phenomeological-background_files/figure-html/fig-illustration-double-richards-model-1.png" class="img-fluid figure-img" width="672"></p>
<p></p><figcaption class="figure-caption">Figure&nbsp;6.7: Illustration of a Double Richards model for different values for <span class="math inline">\(r_1\)</span> and <span class="math inline">\(r_2\)</span>, with <span class="math inline">\(K_1=2,500\)</span>, <span class="math inline">\(K_2 = 5,000\)</span>, <span class="math inline">\(\tau_1 = 20\)</span>, <span class="math inline">\(\tau_2 = 40\)</span>“, <span class="math inline">\(\delta_1 = \delta_2 = .5\)</span></figcaption><p></p>
</figure>
</div>
</div>
</div>


<div id="refs" class="references csl-bib-body hanging-indent" role="doc-bibliography" style="display: none">
<div id="ref-bock_1973_HB" class="csl-entry" role="doc-biblioentry">
Bock, R. Darrell, Howard Wainer, Anne Petersen, David Thissen, James Murray, and Alex Roche. 1973. <span>“A Parameterization for Individual Human Growth Curves.”</span> <em>Human Biology</em> 45 (1): 63–80. <a href="http://www.jstor.org/stable/41459847">http://www.jstor.org/stable/41459847</a>.
</div>
<div id="ref-gompertz_nature_1825" class="csl-entry" role="doc-biblioentry">
Gompertz, Benjamin. 1825. <span>“On the Nature of the Function Expressive of the Law of Human Mortality, and on a New Mode of Determining the Value of Life Contingencies.”</span> <em>Philosophical Transactions of the Royal Society of London</em> 115 (December): 513–83. <a href="https://doi.org/10.1098/rstl.1825.0026">https://doi.org/10.1098/rstl.1825.0026</a>.
</div>
<div id="ref-lee_estimation_2020" class="csl-entry" role="doc-biblioentry">
Lee, Se Yoon, Bowen Lei, and Bani Mallick. 2020. <span>“Estimation of <span>COVID</span>-19 Spread Curves Integrating Global Data and Borrowing Information.”</span> <em>PLOS ONE</em> 15 (7): e0236860. <a href="https://doi.org/10.1371/journal.pone.0236860">https://doi.org/10.1371/journal.pone.0236860</a>.
</div>
<div id="ref-Lipovetsky_2010_JoAS" class="csl-entry" role="doc-biblioentry">
Lipovetsky, Stan. 2010. <span>“Double Logistic Curve in Regression Modeling.”</span> <em>Journal of Applied Statistics</em> 37 (11): 1785–93. <a href="https://doi.org/10.1080/02664760903093633">https://doi.org/10.1080/02664760903093633</a>.
</div>
<div id="ref-ma_estimating_2020" class="csl-entry" role="doc-biblioentry">
Ma, Junling. 2020. <span>“Estimating Epidemic Exponential Growth Rate and Basic Reproduction Number.”</span> <em>Infectious Disease Modelling</em> 5 (January): 129–41. <a href="https://doi.org/10.1016/j.idm.2019.12.009">https://doi.org/10.1016/j.idm.2019.12.009</a>.
</div>
<div id="ref-Oswald_2012_FlexParamCurve" class="csl-entry" role="doc-biblioentry">
Oswald, Stephen A., Ian C. T. Nisbet, Andre Chiaradia, and Jennifer M. Arnold. 2012. <span>“<span>FlexParamCurve</span>: <span>R</span> Package for Flexible Fitting of Nonlinear Parametric Curves.”</span> <em>Methods in Ecology and Evolution</em> 3 (6): 1073–77. <a href="https://doi.org/10.1111/j.2041-210x.2012.00231.x">https://doi.org/10.1111/j.2041-210x.2012.00231.x</a>.
</div>
<div id="ref-richards_flexible_1959" class="csl-entry" role="doc-biblioentry">
Richards, F. J. 1959. <span>“A Flexible Growth Function for Empirical Use.”</span> <em>Journal of Experimental Botany</em> 10 (2): 290–301. <a href="https://doi.org/10.1093/jxb/10.2.290">https://doi.org/10.1093/jxb/10.2.290</a>.
</div>
<div id="ref-Thissen_1976_AHB" class="csl-entry" role="doc-biblioentry">
Thissen, David, R. Darrell Bock, Howard Wainer, and Alex F. Roche. 1976. <span>“Individual Growth in Stature: <span>A</span> Comparison of Four Growth Studies in the <span>U.S.A.</span>”</span> <em>Annals of Human Biology</em> 3 (6): 529–42. <a href="https://doi.org/10.1080/03014467600001791">https://doi.org/10.1080/03014467600001791</a>.
</div>
<div id="ref-tjorve_use_2017" class="csl-entry" role="doc-biblioentry">
Tjørve, Kathleen M. C., and Even Tjørve. 2017. <span>“The Use of <span>Gompertz</span> Models in Growth Analyses, and New <span>Gompertz</span>-Model Approach: <span>An</span> Addition to the <span>Unified</span>-<span>Richards</span> Family.”</span> <em>PLOS ONE</em> 12 (6): e0178691. <a href="https://doi.org/10.1371/journal.pone.0178691">https://doi.org/10.1371/journal.pone.0178691</a>.
</div>
<div id="ref-tsoularis_analysis_2002" class="csl-entry" role="doc-biblioentry">
Tsoularis, A., and J. Wallace. 2002. <span>“Analysis of Logistic Growth Models.”</span> <em>Mathematical Biosciences</em> 179 (1): 21–55. <a href="https://doi.org/10.1016/S0025-5564(02)00096-2">https://doi.org/10.1016/S0025-5564(02)00096-2</a>.
</div>
<div id="ref-verhulst_recherches_1845" class="csl-entry" role="doc-biblioentry">
Verhulst, P. F. 1845. <span>“Recherches Math<span>é</span>matiques Sur La Loi d’accroissement de La Population.”</span> <em>Nouveaux m<span>é</span>moires de l’Acad<span>é</span>mie Royale Des Sciences Et Belles-Lettres de Bruxelles</em> 18: 14–54. <a href="https://eudml.org/doc/182533">https://eudml.org/doc/182533</a>.
</div>
<div id="ref-Wang-etal2012" class="csl-entry" role="doc-biblioentry">
Wang, Xiang-Sheng, Jianhong Wu, and Yong Yang. 2012. <span>“Richards Model Revisited: Validation by and Application to Infection Dynamics.”</span> <em>Journal of Theoretical Biology</em> 313: 12–19. <a href="https://doi.org/10.1016/j.jtbi.2012.07.024">https://doi.org/10.1016/j.jtbi.2012.07.024</a>.
</div>
</div>
</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./reproduction-number.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Estimating the reproduction number</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./phenomenological-models.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Phenomenological Models</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->



</body></html>